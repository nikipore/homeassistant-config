[{"id":"79ddab3e.2ca0c4","type":"tab","label":"Rolladensteuerung","disabled":false,"info":""},{"id":"e6cb2a0bf9f73b5e","type":"tab","label":"Lichtkuppelsteuerung","disabled":false,"info":"","env":[]},{"id":"862f2b64f79c5535","type":"tab","label":"Heizung","disabled":false,"info":"","env":[]},{"id":"9bf7fb6e.7aac88","type":"tab","label":"Beleuchtung","disabled":false,"info":""},{"id":"f2681015255691ca","type":"tab","label":"Waschmaschine","disabled":false,"info":"","env":[]},{"id":"e12ba8ee5e5db754","type":"tab","label":"Steckdosen","disabled":false,"info":"","env":[]},{"id":"ebbdd091a0245e61","type":"junction","z":"79ddab3e.2ca0c4","x":3060,"y":160,"wires":[["6519afc9.b92dd","b7461eaa.f9dbc"]]},{"id":"a0992e23.0acf8","type":"server","name":"Home Assistant","version":5,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true,"heartbeat":false,"heartbeatInterval":30,"areaSelector":"friendlyName","deviceSelector":"friendlyName","entitySelector":"friendlyName","statusSeparator":"at: ","statusYear":"hidden","statusMonth":"short","statusDay":"numeric","statusHourCycle":"h23","statusTimeFormat":"h:m","enableGlobalContextStore":true},{"id":"a962ddc.fbff22","type":"position-config","name":"Kostheimer Landstraße 17, 55246 Mainz-Kostheim","isValide":"true","longitude":"0","latitude":"0","angleType":"deg","timeZoneOffset":99,"timeZoneDST":0,"stateTimeFormat":"3","stateDateFormat":"12","contextStore":""},{"id":"dc1fcbdb1d762196","type":"mqtt-broker","name":"","broker":"core-mosquitto","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"e3a7303ba129b85d","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Badezimmer","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_badezimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"a97f891155a24fe3","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Duschbad","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_duschbad"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"ae24157bbcb644ae","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Nino rechts","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_nino_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"d3d128cf86485fe9","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Nino links","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_nino_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"eaa4cef39e9e250d","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Noah rechts","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_noah_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"3e60f5e82daa1b07","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Noah links","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_noah_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"48110af5440c3632","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Arbeitszimmer","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_arbeitszimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"a52a9b6776be398b","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Küche rechts","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_kueche_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"f30c64467d309263","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Küche links","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_kueche_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"46e7518f5cf3a73c","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Wohnzimmer","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_wohnzimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"4ca41dc63c2fde47","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Terrasse rechts","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_terrasse_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"16575c7735cc6c0d","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Terrasse links","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_terrasse_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"b334a48464a76b79","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Schlafzimmer","version":"6","entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_schlafzimmer"},{"property":"icon","value":""},{"property":"entity_category","value":""},{"property":"entity_picture","value":""},{"property":"device_class","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""}],"resend":true,"debugEnabled":false},{"id":"47d0b5d7940e7cf8","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Waschmaschine: Status","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"Waschmaschine: Status"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:washing-machine"},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"resend":true},{"id":"14c2b510a5d538ec","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Waschmaschine: mittlere Leistung","version":6,"entityType":"sensor","haConfig":[{"property":"name","value":"Waschmaschine: mittlere Leistung"},{"property":"device_class","value":"power"},{"property":"icon","value":""},{"property":"unit_of_measurement","value":"W"},{"property":"state_class","value":"measurement"},{"property":"last_reset","value":""}],"resend":true},{"id":"f7f6b5cb42de1990","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Ankleide","version":"6","entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_ankleide"},{"property":"icon","value":""},{"property":"entity_category","value":""},{"property":"entity_picture","value":""},{"property":"device_class","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""}],"resend":true,"debugEnabled":false},{"id":"655c0a4b33cb6821","type":"ha-entity-config","server":"a0992e23.0acf8","deviceConfig":"","name":"sensor config for Flur","version":"6","entityType":"sensor","haConfig":[{"property":"name","value":"blind_control_flur"},{"property":"icon","value":""},{"property":"entity_category","value":""},{"property":"entity_picture","value":""},{"property":"device_class","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""}],"resend":true,"debugEnabled":false},{"id":"6f4e279d.892e58","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sonnenstandsteuerung","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_select.blind_control_mode_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"mode","valueType":"str"}],"x":2220,"y":1000,"wires":[["0a2bb773d63e8173"]]},{"id":"1151bc6f.c175d4","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Werktag (heute)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.is_workday_today","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":2240,"y":460,"wires":[["30aa6cf2.546b44"]]},{"id":"30aa6cf2.546b44","type":"change","z":"79ddab3e.2ca0c4","name":"flow.dayInfo.today.isWorkday","rules":[{"t":"set","p":"#:(store)::dayInfo.today.isWorkday","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":460,"wires":[[]]},{"id":"b6fe5f32.faeab","type":"change","z":"79ddab3e.2ca0c4","name":"flow.dayInfo.tomorrow.isWorkday","rules":[{"t":"set","p":"#:(store)::dayInfo.tomorrow.isWorkday","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2520,"y":520,"wires":[[]]},{"id":"edb8b9f2.f56048","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Werktag (morgen)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.is_workday_tomorrow","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":2240,"y":520,"wires":[["b6fe5f32.faeab"]]},{"id":"8651207e.ecb56","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"frühestens von (Werktag)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_datetime.blind_control_from_earliest_workday_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"fromEarliestWorkday","valueType":"str"}],"x":2210,"y":1060,"wires":[["fd491e534e631780"]]},{"id":"3116bee7.185eb2","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"spätestens bis (Werktag)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_datetime.blind_control_until_latest_workday_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"untilLatestWorkday","valueType":"str"}],"x":2210,"y":1120,"wires":[["9035f80b69bd98f0"]]},{"id":"601d4000.d7862","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"frühestens von (Feiertag)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_datetime.blind_control_from_earliest_holiday_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"fromEarliestHoliday","valueType":"str"}],"x":2210,"y":1180,"wires":[["e199d655b2088b5a"]]},{"id":"ee2d0a99.94f108","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"spätestens bis (Feiertag)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_datetime.blind_control_until_latest_holiday_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"untilLatestHoliday","valueType":"str"}],"x":2210,"y":1240,"wires":[["ba361d41b9ffa99d"]]},{"id":"b7461eaa.f9dbc","type":"debug","z":"79ddab3e.2ca0c4","name":"Steuerung","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3170,"y":140,"wires":[]},{"id":"7d786999.13a9f8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Höchsttemperatur (Vorhersage)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.weather_forecast_temperature_high","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"topic","propertyType":"msg","value":"temperatureMax","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2190,"y":1440,"wires":[["fd04dc1.3be172"]]},{"id":"5b82690d.e999e8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Tiefsttemperatur (Vorhersage)","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.weather_forecast_temperature_low","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"topic","propertyType":"msg","value":"temperatureMin","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2200,"y":1380,"wires":[["fd04dc1.3be172"]]},{"id":"385c87d5.6c0e88","type":"switch","z":"79ddab3e.2ca0c4","name":"temperature < threshold?","property":"payload.temperature","propertyType":"msg","rules":[{"t":"lt","v":"payload.parameter_summer_t","vt":"msg"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2610,"y":1860,"wires":[["f44628aa.f71908"],["bed79daf.c6b7d"]]},{"id":"c4a66df1.cec7d","type":"switch","z":"79ddab3e.2ca0c4","name":"temperatureMin < threshold?","property":"payload.temperatureMin","propertyType":"msg","rules":[{"t":"lt","v":"payload.parameter_winter_tmin","vt":"msg"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2620,"y":1680,"wires":[["e63204c4232f5c0f"],["00867c7e2cb81a14"]]},{"id":"d3845079.e7563","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Automatik Sonnenstandsteuerung","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_boolean.blind_control_auto_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"auto","valueType":"str"}],"x":2180,"y":940,"wires":[["ec2c35e0822b86cc"]]},{"id":"fd04dc1.3be172","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":2430,"y":1560,"wires":[["b9231714.1f2478"]]},{"id":"b9231714.1f2478","type":"switch","z":"79ddab3e.2ca0c4","name":"vollständig?","property":"$count($keys(msg.payload)) = 9","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":2570,"y":1560,"wires":[["61b62ef1.adae4"]]},{"id":"f44628aa.f71908","type":"change","z":"79ddab3e.2ca0c4","name":"aus","rules":[{"t":"set","p":"mode","pt":"msg","to":"aus","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":1760,"wires":[["c5a6faae05d2e625"]]},{"id":"7936bb15.899f44","type":"change","z":"79ddab3e.2ca0c4","name":"Winter","rules":[{"t":"set","p":"mode","pt":"msg","to":"Winter","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":1680,"wires":[["c5a6faae05d2e625"]]},{"id":"bed79daf.c6b7d","type":"change","z":"79ddab3e.2ca0c4","name":"Sommer","rules":[{"t":"set","p":"mode","pt":"msg","to":"Sommer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3100,"y":1840,"wires":[["c5a6faae05d2e625"]]},{"id":"1db35bfa.d0aa34","type":"api-call-service","z":"79ddab3e.2ca0c4","name":"setze Schalter","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"{{domain}}","service":"{{service}}","areaId":[],"deviceId":[],"entityId":["{{entity_id}}"],"data":"msg.data","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":3780,"y":640,"wires":[[]]},{"id":"ce0e9316.3ec58","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sonnenleistung","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.wiesbaden_biebrich_sonneneinstrahlung","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"topic","propertyType":"msg","value":"solarPower","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2240,"y":1500,"wires":[["fd04dc1.3be172"]]},{"id":"61b62ef1.adae4","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2750,"y":1560,"wires":[["c4a66df1.cec7d"]]},{"id":"175fcd54.ff9613","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.door_sensor_terrasse_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1520,"wires":[["7a8ae7b.f6d2418"]]},{"id":"76e1cfbd.5e675","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["bf339f52.8d3c3","eb4d638e.59791","ba177608.e92ab8","dd7c30f0.2eb05","be200807.b749a8","661839b6.633208","a1ae5ee8.854af","c188372f.98fd48","d49691fd.0934f","3dd26aec.942b06","95d229d3.7c7388","3ad59bfd.393924","e4f75033.5104a","2f4137b4.c4b378","6aefb8a1.904188","e52c7c5.cdae08","fc9c88a6.86e0d8","a0a23d41.66767","405db6c2.e8e7b8","f6b52548.51de08","4311b1da.6fb3d","919d6b96.053878","766c8887.e38e78","e5d34195.e1dbd","63916888.267688","14f40dc0.294162","be7ad3c4.d4286","cd3ac6f9.3d2558","b1b8e0d6.83f92","42c34c14.ad5d94","845c5fe1.7c90b","5b81bd3d.5a99c4","902b3788.3b5bb8","99c6882.54cde78","e9b0bfd7.1a1b3","2e93feda.d44822","df7e68411ccc9725","1157a4302841530b"],"x":135,"y":160,"wires":[]},{"id":"e0d80bf0.6f4108","type":"comment","z":"79ddab3e.2ca0c4","name":"Trigger","info":"","x":2110,"y":80,"wires":[]},{"id":"6b112f75.88842","type":"comment","z":"79ddab3e.2ca0c4","name":"Kontext","info":"","x":2110,"y":380,"wires":[]},{"id":"c3a214dc.3e49f8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_wohnzimmer_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1360,"wires":[["f48275fc.3b24f8"]]},{"id":"e793a7c0.212528","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_kueche_links_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1220,"wires":[["ed068856.607ad8"]]},{"id":"c9db3695.83a1a8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_kueche_rechts_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1140,"wires":[["f08ac1a8.b9091"]]},{"id":"51bf045.f7b99fc","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_badezimmer_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":260,"wires":[["83f37a28.e1a038"]]},{"id":"8719beb2.469b","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladenautomatik aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext($join(['options', 'active', msg.room], '.'), 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":1470,"y":120,"wires":[["a9110e36a7ebdcc5"]]},{"id":"5577b3ee.823b5c","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_duschbad_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":400,"wires":[["b84086f8.fd1638"]]},{"id":"bc8663a5.9c478","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_arbeitszimmer_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1000,"wires":[["8122fd4b173686be"]]},{"id":"2d808d1e.af01b2","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_noah_links_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":860,"wires":[["6c4f0fcd.c6b12"]]},{"id":"b446f873.d01658","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_boolean.blind_control_active_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"active","valueType":"str"}],"x":2210,"y":880,"wires":[["244f21dafbf5d350"]]},{"id":"c715ba47.4785c8","type":"switch","z":"79ddab3e.2ca0c4","name":"vollständig?","property":"$count($keys(msg.payload)) = $count($flowContext(\"rooms\", \"store\"))","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":2590,"y":960,"wires":[["e8ab95464a84507e"]]},{"id":"a7fe70e9.87fac","type":"change","z":"79ddab3e.2ca0c4","name":"triggerOnly","rules":[{"t":"set","p":"topic","pt":"msg","to":"triggerOnly","tot":"str"},{"t":"set","p":"room","pt":"msg","to":"global","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2950,"y":140,"wires":[["ebbdd091a0245e61"]]},{"id":"b73c2ea3.ec314","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung gesondert je Raum","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_boolean.blind_control_specific_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"specific","valueType":"str"}],"x":2170,"y":700,"wires":[["1fafbd65.55bab3"]]},{"id":"761423cd.d3881c","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"#:(store)::autoMode","pt":"flow","to":"mode","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3580,"y":1760,"wires":[["6efe762.a068f88"]]},{"id":"5c995479.83034c","type":"function","z":"79ddab3e.2ca0c4","name":"aktualisiere flow.options","func":"flow.get(\"options\", \"store\")[msg.field] = msg.payload;\n\nreturn {};","outputs":1,"noerr":0,"initialize":"// Der Code hier wird ausgeführt,\n// wenn der Node gestartet wird\nvar storeName = \"store\";\nflow.set(\"options\", flow.get(\"options\", storeName) || {}, storeName);","finalize":"","libs":[],"x":2970,"y":960,"wires":[["a86c098b.8ba4c8"]]},{"id":"1fafbd65.55bab3","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":700,"wires":[["c715ba47.4785c8"]]},{"id":"2037cd9a.b30ad2","type":"inject","z":"79ddab3e.2ca0c4","name":"rooms","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"0","topic":"","payload":"[\"global\", \"ankleide\", \"badezimmer\", \"duschbad\", \"flur\", \"nino\", \"noah\", \"arbeitszimmer\", \"kueche\", \"wohnzimmer\", \"schlafzimmer\"]","payloadType":"json","x":2270,"y":620,"wires":[["bc9cd8d5.1d0278"]]},{"id":"bc9cd8d5.1d0278","type":"change","z":"79ddab3e.2ca0c4","name":"flow.rooms","rules":[{"t":"set","p":"#:(store)::rooms","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2450,"y":620,"wires":[[]]},{"id":"728c1078.b44f8","type":"trigger","z":"79ddab3e.2ca0c4","name":"","op1":"","op2":"#:(store)::rooms","op1type":"nul","op2type":"flow","duration":"250","extend":true,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":2980,"y":400,"wires":[["2a63a172.fa0c5e"]]},{"id":"2a63a172.fa0c5e","type":"split","z":"79ddab3e.2ca0c4","name":"split rooms","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":3150,"y":400,"wires":[["22977410.1a619c"]]},{"id":"22977410.1a619c","type":"function","z":"79ddab3e.2ca0c4","name":"berechne Inputs neu","func":"var room = msg.payload;\nvar storeName = \"store\";\n\nvar options = flow.get(\"options\", storeName);\nvar specific = options[\"specific\"][\"global\"] ? false : options[\"specific\"][room];\nvar lookup = (field => options[field][specific ? room : \"global\"]);\nvar auto = lookup(\"auto\");\n\nreturn [[\n    {\"room\": room, \"field\": \"position\", \"payload\": lookup(\"position\")},\n    {\"room\": room, \"field\": \"mode\", \"payload\": auto ? flow.get(\"autoMode\", storeName) : lookup(\"mode\") },\n    {\"room\": room, \"field\": \"specific\", \"payload\": specific },\n    {\"room\": room, \"field\": \"auto\", \"payload\": auto },\n    {\"room\": room, \"field\": \"active\", \"payload\": lookup(\"active\")},\n    {\"room\": room, \"field\": \"ventilate\", \"payload\": lookup(\"ventilate\") },\n    { \"room\": room, \"field\": \"from_earliest_workday\", \"payload\": lookup(\"fromEarliestWorkday\")},\n    { \"room\": room, \"field\": \"until_latest_workday\", \"payload\": lookup(\"untilLatestWorkday\")},\n    { \"room\": room, \"field\": \"from_earliest_holiday\", \"payload\": lookup(\"fromEarliestHoliday\")},\n    { \"room\": room, \"field\": \"until_latest_holiday\", \"payload\": lookup(\"untilLatestHoliday\")}\n]];\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3340,"y":400,"wires":[["34f03d.96498fc4"]]},{"id":"cb001993.b57198","type":"function","z":"79ddab3e.2ca0c4","name":"generiere Service Call","func":"var domain = type => `input_${type}`;\n\nfunction entity (type, field, room) {\n    return domain(type) + `.blind_control_${field}_${room}`\n}\n\nfunction service (type, value) {\n    return {\n        \"boolean\": value ? \"turn_on\" : \"turn_off\",\n        \"select\": \"select_option\",\n        \"number\": \"set_value\",\n        \"datetime\": \"set_datetime\"\n    }[type]\n}\n\nfunction data (type, value) {\n    switch (type) {\n        case \"select\":\n            return {\"option\": value};\n        case \"number\":\n            return {\"value\": value};\n        case \"datetime\":\n            return {\"time\": value};\n    }\n}\n\nfunction message (room, field, value) {\n    var type = {\n        \"active\": \"boolean\",\n        \"auto\": \"boolean\",\n        \"specific\": \"boolean\",\n        \"mode\": \"select\",\n        \"ventilate\": \"select\",\n        \"position\": \"number\",\n        \"from_earliest_workday\": \"datetime\",\n        \"until_latest_workday\": \"datetime\",\n        \"from_earliest_holiday\": \"datetime\",\n        \"until_latest_holiday\": \"datetime\"\n    }[field];\n    return {\n        \"domain\": domain(type),\n        \"service\": service(type, value),\n        \"entity_id\": entity(type, field, room),\n        \"data\": data(type, value)\n    }\n}\n\nreturn message(msg.room, msg.field, msg.payload);\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3580,"y":640,"wires":[["1db35bfa.d0aa34"]]},{"id":"a86c098b.8ba4c8","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["ff6e5cc9.4478f"],"x":3115,"y":960,"wires":[]},{"id":"ff6e5cc9.4478f","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["a86c098b.8ba4c8","6efe762.a068f88","cd1137f4.399fe8"],"x":2855,"y":400,"wires":[["728c1078.b44f8"]]},{"id":"146418ff.2a3997","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Override: Position","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_number.blind_control_position_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"position","valueType":"str"}],"x":2230,"y":820,"wires":[["ecdd87f95ff4b8b7"]]},{"id":"a3154844.b958b8","type":"link in","z":"79ddab3e.2ca0c4","name":"Kontextänderung","links":["79875059.6dd7","6ac1134a.417f2c"],"x":3005,"y":180,"wires":[["ebbdd091a0245e61"]]},{"id":"cd3ac6f9.3d2558","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":1080,"wires":[["12c64dcb.aac152"]]},{"id":"12c64dcb.aac152","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(kueche|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":1080,"wires":[["f08ac1a8.b9091","ed068856.607ad8"]]},{"id":"c1ca23b4.9fab3","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(wohnzimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":1300,"wires":[["8a0c6daa.f80d2","7a8ae7b.f6d2418","f48275fc.3b24f8"]]},{"id":"b1b8e0d6.83f92","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":1300,"wires":[["c1ca23b4.9fab3"]]},{"id":"fa839915.e84128","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(schlafzimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":1600,"wires":[["c991f710.fbeda8"]]},{"id":"42c34c14.ad5d94","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":1600,"wires":[["fa839915.e84128"]]},{"id":"361f5f1d.898cf","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(badezimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":200,"wires":[["83f37a28.e1a038"]]},{"id":"845c5fe1.7c90b","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":200,"wires":[["361f5f1d.898cf"]]},{"id":"41868de8.4a21a4","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(duschbad|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":340,"wires":[["b84086f8.fd1638"]]},{"id":"5b81bd3d.5a99c4","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":340,"wires":[["41868de8.4a21a4"]]},{"id":"84f6025.886c7","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(nino|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":480,"wires":[["530d0076.f4c11","930b0dd4.d787"]]},{"id":"902b3788.3b5bb8","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":480,"wires":[["84f6025.886c7"]]},{"id":"d9184e83.1f921","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(noah|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":720,"wires":[["52fdd7e6.9f26f8","6c4f0fcd.c6b12"]]},{"id":"99c6882.54cde78","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":720,"wires":[["d9184e83.1f921"]]},{"id":"bad33b7.474eac8","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(arbeitszimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":940,"wires":[["8122fd4b173686be"]]},{"id":"e9b0bfd7.1a1b3","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":940,"wires":[["bad33b7.474eac8"]]},{"id":"34f03d.96498fc4","type":"switch","z":"79ddab3e.2ca0c4","name":"Steuernachricht?","property":"field","propertyType":"msg","rules":[{"t":"eq","v":"position","vt":"str"},{"t":"eq","v":"mode","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":3170,"y":540,"wires":[["a0d99161.bcc13"],["91813548.074448"],["cb001993.b57198"]]},{"id":"79875059.6dd7","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["df9da4f4.93f5c8","726300f6.eb244","cf2d806a.d6fad","75758e65.16128","3aad7d02.afaef2","2aacee48.8e2122","9d95ce88.fa71c","ff22d323.85a78","a3154844.b958b8"],"x":3755,"y":460,"wires":[]},{"id":"a0d99161.bcc13","type":"function","z":"79ddab3e.2ca0c4","name":"position","func":"var header = {\n    \"room\": msg.room,\n    \"reason\": \"manual\"\n};\n\nvar positionMessages = []\nswitch (msg.payload) {\n    case -20:\n        msg.payload = -10;\n        positionMessages.push({\n            ...header,\n            \"reset\": true\n        });\n        break\n    case -10:\n        break;\n    default:\n        positionMessages.push({\n            ...header,\n            \"position\": msg.payload / 100\n        });\n}\n\nreturn [positionMessages, msg];\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3420,"y":500,"wires":[["180efc32.3c6dd4"],["cb001993.b57198"]]},{"id":"180efc32.3c6dd4","type":"switch","z":"79ddab3e.2ca0c4","name":"room != global?","property":"room","propertyType":"msg","rules":[{"t":"neq","v":"global","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":3640,"y":460,"wires":[["79875059.6dd7"]]},{"id":"f0e61790.f3e668","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":[],"x":-35,"y":140,"wires":[[]]},{"id":"2957dfef.1b5b6","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":[],"x":-35,"y":280,"wires":[[]]},{"id":"682cbbf.605b544","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["6519afc9.b92dd"],"x":75,"y":160,"wires":[["76e1cfbd.5e675"]]},{"id":"6519afc9.b92dd","type":"link out","z":"79ddab3e.2ca0c4","name":"Steuerung","links":["682cbbf.605b544","867430b5177b495e"],"x":3115,"y":180,"wires":[]},{"id":"91813548.074448","type":"function","z":"79ddab3e.2ca0c4","name":"mode","func":"var modes = {\n    \"aus\": 0,\n    \"Winter\": 1,\n    \"Sonnenlicht minimieren\": 3,\n    \"Sommer\": 16\n};\n\nreturn [\n    {\"room\": msg.room, \"mode\": modes[msg.payload]},\n    msg\n];\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3410,"y":540,"wires":[["180efc32.3c6dd4"],["cb001993.b57198"]]},{"id":"84c36164.fcef2","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Regen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.weather_raining","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"condition","propertyType":"msg","value":"raining","valueType":"str"}],"x":2270,"y":140,"wires":[["d790669c11582d9d"]]},{"id":"6efe762.a068f88","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["ff6e5cc9.4478f"],"x":3715,"y":1760,"wires":[]},{"id":"8a0c6daa.f80d2","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Terrasse – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"wohnzimmer","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_terrasse_rechts","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"marqueeOpen","operator":"equal","operatorText":"=","thresholdType":"bool","threshold":"true"},{"condition":2,"conditionText":"und","valueType":"pdsCalcAzimuth","value":"","operator":"lt","operatorText":"<","thresholdType":"numAzimuth","threshold":"235"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.marqueeOpen</var> = true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>\"Sonnenrichtung\"</var> < \"Sonnenrichtung\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>","exec":0},{"index":1,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....mEarliestWorkday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0},{"index":2,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....mEarliestHoliday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0},{"index":3,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""},"exec":0},{"index":4,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>","exec":0},{"index":5,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....tilLatestWorkday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0},{"index":6,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....tilLatestHoliday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1.98","windowBottomType":"num","windowBottom":"0.27","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"131","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"285","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":610,"y":1440,"wires":[["4f2c53a1c2f7883e","5e965bfd51605537"],[]]},{"id":"7a8ae7b.f6d2418","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Terrasse – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"wohnzimmer","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_terrasse_links","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>","exec":0},{"index":1,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"marqueeOpen","operator":"equal","operatorText":"=","thresholdType":"bool","threshold":"true"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.marqueeOpen</var> = true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>","exec":0},{"index":2,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....mEarliestWorkday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0},{"index":3,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....mEarliestHoliday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0},{"index":4,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""},"exec":0},{"index":5,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>","exec":0},{"index":6,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....tilLatestWorkday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0},{"index":7,"name":"","version":4,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"days":"*","months":"*","start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}}},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....tilLatestHoliday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","exec":0}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1.98","windowBottomType":"num","windowBottom":"0.27","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"131","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"285","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":600,"y":1520,"wires":[["e9c5ed68717ae4d7","5e965bfd51605537"],[]]},{"id":"c991f710.fbeda8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Schlafzimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"schlafzimmer","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_schlafzimmer","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.schlafzimmer","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.schlafzimmer</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.schlafzimmer","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.schlafzimmer</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.schlafzimmer","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.schlafzimmer</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....arliestWorkday.schlafzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....arliestHoliday.schlafzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"slat":{"type":"none","value":""},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> undefined</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> undefined <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....lLatestWorkday.schlafzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....lLatestHoliday.schlafzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.51","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"128","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"282","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":600,"y":1660,"wires":[["6afb5f45f5f33df0","967bac7c7fd74654"],[]]},{"id":"8b6f1e7a.974c6","type":"comment","z":"79ddab3e.2ca0c4","name":"Rolläden","info":"","x":200,"y":80,"wires":[]},{"id":"76b5c7b0.3f5978","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sturm","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.weather_storm","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"","forType":"num","forUnits":"seconds","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"condition","propertyType":"msg","value":"storm","valueType":"str"},{"property":"delay","propertyType":"msg","value":"300000","valueType":"num"}],"x":2270,"y":200,"wires":[["7f08c86c.4cf0b8"]]},{"id":"7f08c86c.4cf0b8","type":"change","z":"79ddab3e.2ca0c4","name":"alert & reset","rules":[{"t":"set","p":"#:(store)::alert","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"reset","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2450,"y":200,"wires":[["1d04ceb5.641b11"]]},{"id":"f48275fc.3b24f8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Wohnzimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"wohnzimmer","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_wohnzimmer","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.wohnzimmer","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.wohnzimmer</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.wohnzimmer","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.wohnzimmer</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.wohnzimmer","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.wohnzimmer</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....mEarliestWorkday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....mEarliestHoliday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....tilLatestWorkday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....tilLatestHoliday.wohnzimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1.96","windowBottomType":"num","windowBottom":"0.51","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"217","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"13","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[{"mode":16,"valueType":"pdsCalcElevation","value":"","operator":"lt","operatorText":"<","thresholdType":"numAltitude","threshold":"20.68","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":590,"y":1360,"wires":[["31d2028014739634","5e965bfd51605537"],[]]},{"id":"ed068856.607ad8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Küche – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"kueche","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_kueche_links","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.kueche","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.kueche</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.kueche","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.kueche</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.kueche","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.kueche</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow.....fromEarliestWorkday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow.....fromEarliestHoliday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....s.untilLatestWorkday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....s.untilLatestHoliday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"1.02","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"220","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"10","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[{"mode":16,"valueType":"pdsCalcElevation","value":"","operator":"lt","operatorText":"<","thresholdType":"numAltitude","threshold":"20.68","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":590,"y":1220,"wires":[["5eaea3189d44f08b","21b635ac96f2c1d6"],[]]},{"id":"f08ac1a8.b9091","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Küche – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"kueche","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_kueche_rechts","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.kueche","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.kueche</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.kueche","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.kueche</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.kueche","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.kueche</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow.....fromEarliestWorkday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow.....fromEarliestHoliday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....s.untilLatestWorkday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....s.untilLatestHoliday.kueche</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"1.02","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":600,"y":1140,"wires":[["7c894f1cb2019a8f","21b635ac96f2c1d6"],[]]},{"id":"6c4f0fcd.c6b12","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Noah – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"noah","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_noah_links","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.noah","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.noah</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.noah","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.noah</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.noah","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.noah</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestWorkday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestHoliday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestWorkday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestHoliday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":590,"y":860,"wires":[["4bcef907fbc87fa6","2daa092ac3be697d"],[]]},{"id":"52fdd7e6.9f26f8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Noah – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"noah","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_noah_rechts","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.noah","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.noah</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.noah","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.noah</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.noah","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.noah</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestWorkday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestHoliday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestWorkday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestHoliday.noah</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":600,"y":780,"wires":[["a3c3dba6f646dd30","2daa092ac3be697d"],[]]},{"id":"530d0076.f4c11","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Nino – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"nino","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_nino_links","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.nino","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.nino</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.nino","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.nino</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.nino","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.nino</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestWorkday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestHoliday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestWorkday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestHoliday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":590,"y":620,"wires":[["72e66221493cbd19","6e6ec0c94db36208"],[]]},{"id":"930b0dd4.d787","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Nino – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"nino","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_nino_rechts","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.nino","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.nino</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.nino","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.nino</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.nino","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.nino</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestWorkday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....ns.fromEarliestHoliday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestWorkday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....ons.untilLatestHoliday.nino</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"40","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"190","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":590,"y":540,"wires":[["b1dc4eee5a9f6a00","6e6ec0c94db36208"],[]]},{"id":"b84086f8.fd1638","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Duschbad","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"duschbad","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_duschbad","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>","slat":{"type":"none","value":""}},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.duschbad","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.duschbad</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.duschbad","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.duschbad</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.duschbad","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.duschbad</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.duschbad","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....romEarliestWorkday.duschbad</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.duschbad","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....romEarliestHoliday.duschbad</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>","slat":{"type":"none","value":""}},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.duschbad","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....untilLatestWorkday.duschbad</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.duschbad","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....untilLatestHoliday.duschbad</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"40","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"190","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":590,"y":400,"wires":[["10a601cfb6994a44","6e762f192a8bed1a"],[]]},{"id":"83f37a28.e1a038","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Badezimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"badezimmer","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_badezimmer","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>","slat":{"type":"none","value":""}},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.badezimmer","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.badezimmer</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.badezimmer","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.badezimmer</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.badezimmer","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.options.ventilate.badezimmer</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.badezimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....mEarliestWorkday.badezimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.badezimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....mEarliestHoliday.badezimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>","slat":{"type":"none","value":""}},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.badezimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....tilLatestWorkday.badezimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.badezimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....tilLatestHoliday.badezimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>","slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"40","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"190","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":590,"y":260,"wires":[["c2586451a1b198b1","f899285acddaacb5"],[]]},{"id":"1d04ceb5.641b11","type":"function","z":"79ddab3e.2ca0c4","name":"aktualisiere flow.conditions","func":"flow.get(\"conditions\", \"store\")[msg.condition] = msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"var storeName = \"store\";\nflow.set(\"conditions\", flow.get(\"conditions\", storeName) || {}, storeName);","finalize":"","libs":[],"x":2700,"y":140,"wires":[["a7fe70e9.87fac"]]},{"id":"40761c1b.eef7f4","type":"inject","z":"79ddab3e.2ca0c4","name":"jede Minute","props":[],"repeat":"","crontab":"*/1 0-23 * * *","once":false,"onceDelay":0.1,"topic":"","x":2750,"y":80,"wires":[["a7fe70e9.87fac"]]},{"id":"26ceed34.40d052","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"aktuelle Temperatur","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.weather_forecast_temperature","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"topic","propertyType":"msg","value":"temperature","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2230,"y":1320,"wires":[["fd04dc1.3be172"]]},{"id":"2f712298.10c6be","type":"switch","z":"79ddab3e.2ca0c4","name":"temperatureMax < threshold?","property":"payload.temperatureMax","propertyType":"msg","rules":[{"t":"lt","v":"payload.parameter_summer_tmax","vt":"msg"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2630,"y":1800,"wires":[["f44628aa.f71908"],["385c87d5.6c0e88"]]},{"id":"cff80483.f75ae8","type":"api-call-service","z":"79ddab3e.2ca0c4","name":"setze Position","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"cover","service":"set_cover_position","areaId":[],"deviceId":[],"entityId":["{{ cover }}"],"data":"{\"position\": 100 * msg.payload}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1380,"y":360,"wires":[[]]},{"id":"3ac3fb86.fd6404","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_schlafzimmer_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1660,"wires":[["c991f710.fbeda8"]]},{"id":"cb118418.8c98c8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_nino_links_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":620,"wires":[["530d0076.f4c11"]]},{"id":"43988701f8ced0ce","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_noah_rechts_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":780,"wires":[["52fdd7e6.9f26f8"]]},{"id":"6780d3c1ad9d280a","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_nino_rechts_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":540,"wires":[["930b0dd4.d787"]]},{"id":"7f9b8a323f3153a5","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Markise offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.markise_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"marqueeOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1440,"wires":[["8a0c6daa.f80d2","7a8ae7b.f6d2418"]]},{"id":"e63204c4232f5c0f","type":"switch","z":"79ddab3e.2ca0c4","name":"temperature < threshold?","property":"payload.temperature","propertyType":"msg","rules":[{"t":"lt","v":"payload.parameter_winter_t","vt":"msg"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2890,"y":1680,"wires":[["7936bb15.899f44"],["00867c7e2cb81a14"]]},{"id":"98b0498fb47c8f9f","type":"delay","z":"79ddab3e.2ca0c4","name":"zufällige Verzögerung (50-150 ms)","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"5","nbRateUnits":"1","rateUnits":"second","randomFirst":"50","randomLast":"150","randomUnits":"milliseconds","drop":false,"allowrate":false,"outputs":1,"x":1440,"y":300,"wires":[["cff80483.f75ae8"]]},{"id":"538a9afc978aa44f","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["c442a344ee1ad8eb","2daa092ac3be697d","5c24514868ec12b8","8ce337035c17b69b","6e762f192a8bed1a","6e6ec0c94db36208","967bac7c7fd74654","3cc436028392b610","21b635ac96f2c1d6","057b7615232aaf3f","f899285acddaacb5","5e965bfd51605537"],"x":935,"y":160,"wires":[["7ea3c7840e521efc"]]},{"id":"454f3db361c3ace8","type":"change","z":"79ddab3e.2ca0c4","name":"lösche msg.reset","rules":[{"t":"delete","p":"reset","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1390,"y":240,"wires":[["98b0498fb47c8f9f"]]},{"id":"d790669c11582d9d","type":"change","z":"79ddab3e.2ca0c4","name":"false","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":2430,"y":140,"wires":[["1d04ceb5.641b11"]]},{"id":"00867c7e2cb81a14","type":"switch","z":"79ddab3e.2ca0c4","name":"solarPower < threshold?","property":"payload.solarPower","propertyType":"msg","rules":[{"t":"lt","v":"payload.parameter_summer_solarpower","vt":"msg"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2610,"y":1740,"wires":[["f44628aa.f71908"],["2f712298.10c6be"]]},{"id":"c2586451a1b198b1","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Badezimmer","entityConfig":"e3a7303ba129b85d","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":240,"wires":[[]]},{"id":"10a601cfb6994a44","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Duschbad","entityConfig":"a97f891155a24fe3","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":380,"wires":[[]]},{"id":"b1dc4eee5a9f6a00","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Nino rechts","entityConfig":"ae24157bbcb644ae","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":520,"wires":[[]]},{"id":"72e66221493cbd19","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Nino links","entityConfig":"d3d128cf86485fe9","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":820,"y":600,"wires":[[]]},{"id":"a3c3dba6f646dd30","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Noah rechts","entityConfig":"eaa4cef39e9e250d","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":760,"wires":[[]]},{"id":"4bcef907fbc87fa6","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Noah links","entityConfig":"3e60f5e82daa1b07","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":840,"wires":[[]]},{"id":"49a34ae8f74bc462","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Arbeitszimmer","entityConfig":"48110af5440c3632","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":840,"y":980,"wires":[[]]},{"id":"7c894f1cb2019a8f","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Küche rechts","entityConfig":"a52a9b6776be398b","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":1120,"wires":[[]]},{"id":"5eaea3189d44f08b","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Küche links","entityConfig":"f30c64467d309263","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":1200,"wires":[[]]},{"id":"31d2028014739634","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Wohnzimmer","entityConfig":"46e7518f5cf3a73c","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":830,"y":1340,"wires":[[]]},{"id":"4f2c53a1c2f7883e","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Terrasse rechts","entityConfig":"4ca41dc63c2fde47","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":840,"y":1420,"wires":[[]]},{"id":"e9c5ed68717ae4d7","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Terrasse links","entityConfig":"16575c7735cc6c0d","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":840,"y":1500,"wires":[[]]},{"id":"6afb5f45f5f33df0","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Schlafzimmer","entityConfig":"b334a48464a76b79","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":840,"y":1640,"wires":[[]]},{"id":"9e0e9b2179c93449","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Winter: Tiefsttemperatur unter","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"input_number.blind_control_auto_parameter_winter_tmin","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"parameter_winter_tmin","valueType":"str"}],"x":2200,"y":1620,"wires":[["fd04dc1.3be172"]]},{"id":"5056138694211e45","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Winter: aktuelle Temperatur unter","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"input_number.blind_control_auto_parameter_winter_t","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"parameter_winter_t","valueType":"str"}],"x":2190,"y":1680,"wires":[["fd04dc1.3be172"]]},{"id":"4e2e12a7cbe3ddd3","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sommer: Höchsttemperatur über","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"input_number.blind_control_auto_parameter_summer_tmax","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"parameter_summer_tmax","valueType":"str"}],"x":2190,"y":1800,"wires":[["fd04dc1.3be172"]]},{"id":"b31708cafef7cb32","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sommer: aktuelle Temperatur über","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"input_number.blind_control_auto_parameter_summer_t","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"parameter_summer_t","valueType":"str"}],"x":2180,"y":1860,"wires":[["fd04dc1.3be172"]]},{"id":"e1ee9635d15723b6","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sommer: Sonnenleistung über","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"input_number.blind_control_auto_parameter_summer_solarpower","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"parameter_summer_solarpower","valueType":"str"}],"x":2200,"y":1740,"wires":[["fd04dc1.3be172"]]},{"id":"c5a6faae05d2e625","type":"rbe","z":"79ddab3e.2ca0c4","name":"automode changed?","func":"rbe","gap":"","start":"","inout":"out","septopics":false,"property":"mode","topi":"topic","x":3360,"y":1760,"wires":[["761423cd.d3881c"]]},{"id":"08c7f7754a21f4cd","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_lichtkuppel_ankleide_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1800,"wires":[["9bca1f4a40bac685"]]},{"id":"d7162dd883c83da6","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(ankleide|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":1740,"wires":[["9bca1f4a40bac685"]]},{"id":"df7e68411ccc9725","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":1740,"wires":[["d7162dd883c83da6"]]},{"id":"9bca1f4a40bac685","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Ankleide","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"ankleide","vt":"str"},{"p":"cover","pt":"msg","v":"cover.plissee_ankleide","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>","slat":{"type":"none","value":""}},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.ankleide","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....romEarliestWorkday.ankleide</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.ankleide","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....romEarliestHoliday.ankleide</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.ankleide","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....untilLatestWorkday.ankleide</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.ankleide","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....untilLatestHoliday.ankleide</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0","sunMinDelta":"","blindPosMin":"closed (min)","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1","windowBottomType":"num","windowBottom":"0","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"0","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"360","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[{"mode":16,"valueType":"pdsCalcElevation","value":"","operator":"lte","operatorText":"≤","thresholdType":"numAltitude","threshold":"20","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":580,"y":1800,"wires":[["76b3efc1a27e55be","5c24514868ec12b8"],[]]},{"id":"76b3efc1a27e55be","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Ankleide","entityConfig":"f7f6b5cb42de1990","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":820,"y":1780,"wires":[[]]},{"id":"551645da88ea962d","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"binary_sensor.window_sensor_lichtkuppel_flur_is_open","entityIdType":"exact","outputInitially":true,"stateType":"habool","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":310,"y":1940,"wires":[["fa46d6bc4e4cb87a"]]},{"id":"6cf8f933a87e68e4","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(flur|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":390,"y":1880,"wires":[["fa46d6bc4e4cb87a"]]},{"id":"1157a4302841530b","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":295,"y":1880,"wires":[["6cf8f933a87e68e4"]]},{"id":"96ca286d9a1454a0","type":"ha-sensor","z":"79ddab3e.2ca0c4","name":"Flur","entityConfig":"655c0a4b33cb6821","version":0,"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"inputOverride":"allow","outputProperties":[],"x":810,"y":1920,"wires":[[]]},{"id":"fa46d6bc4e4cb87a","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Flur","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"flur","vt":"str"},{"p":"cover","pt":"msg","v":"cover.plissee_flur","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>","slat":{"type":"none","value":""}},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.flur","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....ns.fromEarliestWorkday.flur</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.flur","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>bis frühestens (min)</span> <var>flow....ns.fromEarliestHoliday.flur</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.flur","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....ons.untilLatestWorkday.flur</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.flur","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>von spätestens (max)</span> <var>flow....ons.untilLatestHoliday.flur</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>","slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0","sunMinDelta":"","blindPosMin":"closed (min)","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1","windowBottomType":"num","windowBottom":"0","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"0","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"360","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[{"mode":16,"valueType":"pdsCalcElevation","value":"","operator":"lte","operatorText":"≤","thresholdType":"numAltitude","threshold":"20","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":570,"y":1940,"wires":[["96ca286d9a1454a0","8ce337035c17b69b"],[]]},{"id":"ecdd87f95ff4b8b7","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":820,"wires":[["c715ba47.4785c8"]]},{"id":"ba361d41b9ffa99d","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":1240,"wires":[["c715ba47.4785c8"]]},{"id":"e199d655b2088b5a","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":1180,"wires":[["c715ba47.4785c8"]]},{"id":"9035f80b69bd98f0","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":1120,"wires":[["c715ba47.4785c8"]]},{"id":"fd491e534e631780","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":1060,"wires":[["c715ba47.4785c8"]]},{"id":"0a2bb773d63e8173","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":1000,"wires":[["c715ba47.4785c8"]]},{"id":"ec2c35e0822b86cc","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":940,"wires":[["c715ba47.4785c8"]]},{"id":"244f21dafbf5d350","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":880,"wires":[["c715ba47.4785c8"]]},{"id":"e8ab95464a84507e","type":"change","z":"79ddab3e.2ca0c4","name":"entity → room","rules":[{"t":"delete","p":"topic","pt":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$keys($.payload) { $replace($, /.+_/, \"\"): $lookup($$.payload, $) }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2760,"y":960,"wires":[["5c995479.83034c"]]},{"id":"2daa092ac3be697d","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":720,"wires":[]},{"id":"5c24514868ec12b8","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":1740,"wires":[]},{"id":"8ce337035c17b69b","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":1880,"wires":[]},{"id":"6e762f192a8bed1a","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":340,"wires":[]},{"id":"6e6ec0c94db36208","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":480,"wires":[]},{"id":"967bac7c7fd74654","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":1600,"wires":[]},{"id":"5e965bfd51605537","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":1300,"wires":[]},{"id":"21b635ac96f2c1d6","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":1080,"wires":[]},{"id":"057b7615232aaf3f","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":940,"wires":[]},{"id":"f899285acddaacb5","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":775,"y":200,"wires":[]},{"id":"ae67f4373bb204c7","type":"link in","z":"79ddab3e.2ca0c4","name":"link in 2","links":["7ea3c7840e521efc"],"x":1265,"y":120,"wires":[["8719beb2.469b"]]},{"id":"7ea3c7840e521efc","type":"link out","z":"79ddab3e.2ca0c4","name":"link out 2","mode":"link","links":["ae67f4373bb204c7"],"x":995,"y":160,"wires":[]},{"id":"a9110e36a7ebdcc5","type":"api-current-state","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung an?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.blind_control_on_global","state_type":"str","blockInputOverrides":false,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1410,"y":180,"wires":[["454f3db361c3ace8"],[]]},{"id":"73777bd8bec5847a","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Lüftungspräferenz","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_select.blind_control_ventilate_[a-z]+$","entityIdType":"regex","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"ventilate","valueType":"str"}],"x":2230,"y":760,"wires":[["f6ecc0dacf02625b"]]},{"id":"f6ecc0dacf02625b","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2410,"y":760,"wires":[["c715ba47.4785c8"]]},{"id":"8122fd4b173686be","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Arbeitszimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"},{"p":"room","pt":"msg","v":"arbeitszimmer","vt":"str"},{"p":"cover","pt":"msg","v":"cover.roller_shutter_arbeitszimmer","vt":"str"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":1,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.arbeitszimmer","operator":"equal","thresholdType":"str","threshold":"keine"}],"level":{"type":"num","value":"0.15","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow....ons.ventilate.arbeitszimmer</var> = \"keine\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>0.15</var></div></div>"},{"index":2,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.arbeitszimmer","operator":"equal","thresholdType":"str","threshold":"lüften"}],"level":{"type":"levelFixed","value":"66%","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow....ons.ventilate.arbeitszimmer</var> = \"lüften\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>66%</var></div></div>"},{"index":3,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"valueType":"flow","value":"#:(store)::options.ventilate.arbeitszimmer","operator":"equal","thresholdType":"str","threshold":"offen"}],"level":{"type":"levelFixed","value":"open (max)","operator":1},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> is true&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow....ons.ventilate.arbeitszimmer</var> = \"offen\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimum blind position: </span><var>open (max)</var></div></div>"},{"index":4,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....rliestWorkday.arbeitszimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":5,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"end":{"type":"pdsTime","value":"civilDawn","offsetType":"none","offset":"1","multiplier":60000,"min":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ until <var>civil dawn</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>until at the earliest (min)</span> <var>flow....rliestHoliday.arbeitszimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":6,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>open (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>overwrite should expire when rule gets active</span> </div></div>"},{"index":7,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","thresholdType":"num","threshold":"0"},{"condition":2,"valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> is false&nbsp;<strong>and</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> is true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximum blind position: </span><var>50%</var></div></div>"},{"index":8,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....LatestWorkday.arbeitszimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"},{"index":9,"name":"","exec":"0","version":4,"enabled":true,"isValid":true,"validationError":"","conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0},"topic":"","resetOverwrite":false,"importance":0,"time":{"start":{"type":"pdsTime","value":"nauticalDusk","offsetType":"none","offset":"1","multiplier":60000,"max":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000}},"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> is false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ from <var>nautical dusk</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>from no later than (max)</span> <var>flow....LatestHoliday.arbeitszimmer</var></div></div><div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>blind position: </span> ↕ absolute <var>closed (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.51","windowSetMode":"startEnd","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","windowOrientationType":"numAzimuth","windowOrientation":"","windowOffsetN":"","windowOffsetP":"","oversteers":[],"oversteerTopic":"","x":600,"y":1000,"wires":[["057b7615232aaf3f","49a34ae8f74bc462"],[]]},{"id":"83bac197176d7dbc","type":"api-call-service","z":"e6cb2a0bf9f73b5e","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"cover","service":"open_cover","areaId":[],"deviceId":[],"entityId":["{{cover}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":710,"y":480,"wires":[[]]},{"id":"09484e15972ba66a","type":"api-call-service","z":"e6cb2a0bf9f73b5e","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"cover","service":"close_cover","areaId":[],"deviceId":[],"entityId":["{{cover}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":710,"y":560,"wires":[[]]},{"id":"383bbdd3d9984f6d","type":"server-state-changed","z":"e6cb2a0bf9f73b5e","name":"Außentemperatur","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.weather_forecast_temperature","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"outside","valueType":"str"}],"x":220,"y":60,"wires":[["e680d1b46a5b378d","7c3efb0d1a098d8d"]]},{"id":"333103c29cfaa84e","type":"server-state-changed","z":"e6cb2a0bf9f73b5e","name":"Innentemperatur Ankleide","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.thermostat_ankleide_temperature","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"inside","valueType":"str"}],"x":190,"y":140,"wires":[["7c3efb0d1a098d8d"]]},{"id":"6c9531bc134aa759","type":"server-state-changed","z":"e6cb2a0bf9f73b5e","name":"Innentemperatur Flur","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.thermostat_flur_temperature","entityIdType":"exact","outputInitially":true,"stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"inside","valueType":"str"}],"x":200,"y":220,"wires":[["e680d1b46a5b378d"]]},{"id":"7c3efb0d1a098d8d","type":"join","z":"e6cb2a0bf9f73b5e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":450,"y":140,"wires":[["852a762ee830a0ca"]]},{"id":"e680d1b46a5b378d","type":"join","z":"e6cb2a0bf9f73b5e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":450,"y":220,"wires":[["679d3085d4778717"]]},{"id":"852a762ee830a0ca","type":"change","z":"e6cb2a0bf9f73b5e","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ankleide","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":140,"wires":[["04894eeb0b5e4de6"]]},{"id":"679d3085d4778717","type":"change","z":"e6cb2a0bf9f73b5e","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"flur","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":220,"wires":[["04894eeb0b5e4de6"]]},{"id":"04894eeb0b5e4de6","type":"switch","z":"e6cb2a0bf9f73b5e","name":"vollständig?","property":"$count($keys(msg.payload))=2","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":810,"y":180,"wires":[["e58ed7390174dda4"]]},{"id":"97e412c5a4894bb7","type":"switch","z":"e6cb2a0bf9f73b5e","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"ankleide","vt":"str"},{"t":"eq","v":"flur","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":370,"y":360,"wires":[["5f4df0d1e10b6ccc"],["84e06f400de108d0"]]},{"id":"085487eba947d528","type":"link in","z":"e6cb2a0bf9f73b5e","name":"","links":["e58ed7390174dda4"],"x":105,"y":360,"wires":[["f6a866ab5b61fb85"]]},{"id":"e58ed7390174dda4","type":"link out","z":"e6cb2a0bf9f73b5e","name":"","mode":"link","links":["085487eba947d528"],"x":915,"y":180,"wires":[]},{"id":"e87b40933beab24c","type":"trigger","z":"e6cb2a0bf9f73b5e","name":"","op1":"","op2":"0","op1type":"pay","op2type":"str","duration":"-15","extend":false,"overrideDelay":false,"units":"min","reset":"","bytopic":"topic","topic":"topic","outputs":1,"x":750,"y":360,"wires":[["0cba2370995a2446"]]},{"id":"521f632d0195838e","type":"link in","z":"e6cb2a0bf9f73b5e","name":"","links":["062403545e1943bf"],"x":105,"y":520,"wires":[["5dc498fef182bf33"]]},{"id":"062403545e1943bf","type":"link out","z":"e6cb2a0bf9f73b5e","name":"","mode":"link","links":["521f632d0195838e"],"x":1155,"y":360,"wires":[]},{"id":"5dc498fef182bf33","type":"change","z":"e6cb2a0bf9f73b5e","name":"setze Entities","rules":[{"t":"set","p":"cover","pt":"msg","to":"$lookup(\t   {\t       \"ankleide\": \"cover.lichtkuppel_ankleide\",\t       \"flur\": \"cover.lichtkuppel_flur\"\t   },\t   msg.topic\t)","tot":"jsonata"},{"t":"set","p":"autocool","pt":"msg","to":"$lookup(\t   {\t       \"ankleide\": \"input_boolean.auto_cooling_ankleide\",\t       \"flur\": \"input_boolean.auto_cooling_flur\"\t   },\t   msg.topic\t)","tot":"jsonata"},{"t":"delete","p":"hystdirection","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":520,"wires":[["f6881b8fbd88629c"]]},{"id":"f6a866ab5b61fb85","type":"change","z":"e6cb2a0bf9f73b5e","name":"outside – inside","rules":[{"t":"set","p":"payload","pt":"msg","to":"$round(msg.payload.outside-msg.payload.inside, 1)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":360,"wires":[["97e412c5a4894bb7"]]},{"id":"0cba2370995a2446","type":"delay","z":"e6cb2a0bf9f73b5e","name":"","pauseType":"timed","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":1000,"y":360,"wires":[["062403545e1943bf"]]},{"id":"5f4df0d1e10b6ccc","type":"hysteresis","z":"e6cb2a0bf9f73b5e","name":"","rising_threshold":"0.5","falling_threshold":"0","initial_edge":"any","x":520,"y":320,"wires":[["e87b40933beab24c"]]},{"id":"84e06f400de108d0","type":"hysteresis","z":"e6cb2a0bf9f73b5e","name":"","rising_threshold":"0.5","falling_threshold":"0","initial_edge":"any","x":520,"y":400,"wires":[["e87b40933beab24c"]]},{"id":"f6881b8fbd88629c","type":"api-current-state","z":"e6cb2a0bf9f73b5e","name":"autocool?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","entity_id":"{{autocool}}","state_type":"habool","blockInputOverrides":false,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":360,"y":520,"wires":[["e803368737f381f3"],[]]},{"id":"e803368737f381f3","type":"switch","z":"e6cb2a0bf9f73b5e","name":"","property":"edge","propertyType":"msg","rules":[{"t":"eq","v":"falling","vt":"str"},{"t":"eq","v":"rising","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":510,"y":520,"wires":[["83bac197176d7dbc"],["09484e15972ba66a"]]},{"id":"8cd07f72bcc55946","type":"ha-get-entities","z":"862f2b64f79c5535","name":"","server":"a0992e23.0acf8","version":0,"rules":[{"property":"entity_id","logic":"starts_with","value":"climate.","valueType":"str"},{"property":"attributes.model","logic":"is","value":"HmIP-HEATING","valueType":"str"}],"output_type":"array","output_empty_results":true,"output_location_type":"msg","output_location":"entity","output_results_count":1,"x":390,"y":420,"wires":[["84d89c65ee1e4b60"]]},{"id":"fddfc3f5b13d7426","type":"switch","z":"862f2b64f79c5535","name":"drop invalid mode","property":"mode","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":730,"y":360,"wires":[["8cd07f72bcc55946"]]},{"id":"9f8b320cc739a995","type":"api-call-service","z":"862f2b64f79c5535","name":"set mode","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"climate","service":"{{ service }}","areaId":[],"deviceId":[],"entityId":["{{ entity }}"],"data":"{$join([msg.type, \"mode\"], \"_\"): msg.mode }","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":380,"y":480,"wires":[[]]},{"id":"459ddf126e831354","type":"change","z":"862f2b64f79c5535","name":"translate mode","rules":[{"t":"set","p":"mode","pt":"msg","to":"$flowContext(\"modes\", \"store\").$lookup($$.type).$lookup($$.mode)","tot":"jsonata"},{"t":"set","p":"service","pt":"msg","to":"$join([\"set\", msg.type, \"mode\"], \"_\")","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":360,"wires":[["fddfc3f5b13d7426"]]},{"id":"84d89c65ee1e4b60","type":"change","z":"862f2b64f79c5535","name":"entity → entity id","rules":[{"t":"set","p":"entity","pt":"msg","to":"$lookup(msg.entity, \"entity_id\" )","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":420,"wires":[["9f8b320cc739a995"]]},{"id":"fccc9afa1842d915","type":"link in","z":"862f2b64f79c5535","name":"link in 1","links":["b162b315af1b0d81","a4b176753afc5e1f"],"x":285,"y":360,"wires":[["91676a78e0c8e0fc"]]},{"id":"9fa810faf1750de4","type":"time-inject","z":"862f2b64f79c5535","name":"reset daily (preset)","nameInt":"⏲ 20:15 = undefined=undefined","positionConfig":"a962ddc.fbff22","props":[{"p":"entity","pt":"msg","v":"input_boolean.climate_preset_mode_reset_daily","vt":"str","o":"","oT":"none","oM":"60000","f":0,"fS":0,"fT":"Millisekunden UNIX-Zeit","fI":"0","next":true,"days":"*","months":"*","onlyOddDays":false,"onlyEvenDays":false,"onlyOddWeeks":false,"onlyEvenWeeks":false}],"injectTypeSelect":"time","intervalCount":1,"intervalCountType":"num","intervalCountMultiplier":60000,"cron":"","cronType":"cronexpr","time":"20:15","timeType":"entered","offset":0,"offsetType":"none","offsetMultiplier":60000,"timeEnd":"","timeEndType":"entered","timeEndOffset":0,"timeEndOffsetType":"none","timeEndOffsetMultiplier":60000,"timeDays":"*","timeOnlyOddDays":false,"timeOnlyEvenDays":false,"timeOnlyOddWeeks":false,"timeOnlyEvenWeeks":false,"timeMonths":"*","timedatestart":"","timedateend":"","property":"","propertyType":"none","propertyCompare":"true","propertyThreshold":"","propertyThresholdType":"num","timeAlt":"","timeAltType":"entered","timeAltDays":"*","timeAltOnlyOddDays":false,"timeAltOnlyEvenDays":false,"timeAltOnlyOddWeeks":false,"timeAltOnlyEvenWeeks":false,"timeAltMonths":"*","timeAltOffset":0,"timeAltOffsetType":"none","timeAltOffsetMultiplier":60000,"once":false,"onceDelay":0.1,"recalcTime":2,"x":190,"y":200,"wires":[["4cf49158b1f0e9bb"]]},{"id":"359f2cd11802b5ad","type":"inject","z":"862f2b64f79c5535","name":"modes","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"{\"hvac\":{\"Auto\":\"auto\",\"Heizen\":\"heat\",\"Aus\":\"off\"},\"preset\":{\"Boost\":\"boost\",\"Keine\":\"none\",\"Wochenprofil 1\":\"week_program_1\",\"Wochenprofil 2\":\"week_program_2\",\"Wochenprofil 3\":\"week_program_3\"}}","payloadType":"json","x":220,"y":60,"wires":[["0e30ccf1921c8c8b"]]},{"id":"0e30ccf1921c8c8b","type":"change","z":"862f2b64f79c5535","name":"","rules":[{"t":"set","p":"#:(store)::modes","pt":"flow","to":"payload","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":60,"wires":[[]]},{"id":"1882fb31b06344fc","type":"server-state-changed","z":"862f2b64f79c5535","name":"reset now","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"^input_button.climate_(hvac|preset)_mode_reset_now$","entityIdType":"regex","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"entity","propertyType":"msg","value":"","valueType":"triggerId"}],"x":380,"y":260,"wires":[["227984ac67606786"]]},{"id":"a4b176753afc5e1f","type":"link out","z":"862f2b64f79c5535","name":"link out 3","mode":"link","links":["fccc9afa1842d915"],"x":755,"y":220,"wires":[]},{"id":"0df91d3a61161f07","type":"time-inject","z":"862f2b64f79c5535","name":"reset daily (hvac)","nameInt":"⏲ 20:00 = undefined=undefined","positionConfig":"a962ddc.fbff22","props":[{"p":"entity","pt":"msg","v":"input_boolean.climate_hvac_mode_reset_daily","vt":"str","o":"","oT":"none","oM":"60000","f":0,"fS":0,"fT":"Millisekunden UNIX-Zeit","fI":"0","next":true,"days":"*","months":"*","onlyOddDays":false,"onlyEvenDays":false,"onlyOddWeeks":false,"onlyEvenWeeks":false}],"injectTypeSelect":"time","intervalCount":1,"intervalCountType":"num","intervalCountMultiplier":60000,"cron":"","cronType":"cronexpr","time":"20:00","timeType":"entered","offset":0,"offsetType":"none","offsetMultiplier":60000,"timeEnd":"","timeEndType":"entered","timeEndOffset":0,"timeEndOffsetType":"none","timeEndOffsetMultiplier":60000,"timeDays":"*","timeOnlyOddDays":false,"timeOnlyEvenDays":false,"timeOnlyOddWeeks":false,"timeOnlyEvenWeeks":false,"timeMonths":"*","timedatestart":"","timedateend":"","property":"","propertyType":"none","propertyCompare":"true","propertyThreshold":"","propertyThresholdType":"num","timeAlt":"","timeAltType":"entered","timeAltDays":"*","timeAltOnlyOddDays":false,"timeAltOnlyEvenDays":false,"timeAltOnlyOddWeeks":false,"timeAltOnlyEvenWeeks":false,"timeAltMonths":"*","timeAltOffset":0,"timeAltOffsetType":"none","timeAltOffsetMultiplier":60000,"once":false,"onceDelay":0.1,"recalcTime":2,"x":200,"y":140,"wires":[["4cf49158b1f0e9bb"]]},{"id":"4cf49158b1f0e9bb","type":"api-current-state","z":"862f2b64f79c5535","name":"reset daily?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ entity }}","state_type":"str","blockInputOverrides":false,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":390,"y":200,"wires":[["227984ac67606786"],[]]},{"id":"91676a78e0c8e0fc","type":"api-current-state","z":"862f2b64f79c5535","name":"get mode","server":"a0992e23.0acf8","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ entity }}","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"mode","propertyType":"msg","value":"","valueType":"entityState"}],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":380,"y":360,"wires":[["459ddf126e831354"]]},{"id":"227984ac67606786","type":"change","z":"862f2b64f79c5535","name":"determine type & entity","rules":[{"t":"set","p":"type","pt":"msg","to":"$match(msg.entity, /^input_(button|boolean)\\.climate_(hvac|preset)_mode_reset_(daily|now)$/).groups[1]","tot":"jsonata"},{"t":"set","p":"entity","pt":"msg","to":"$join([\"input_select.climate\", msg.type, \"mode\"], \"_\")","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":220,"wires":[["a4b176753afc5e1f"]]},{"id":"c1468a42eea018f0","type":"switch","z":"9bf7fb6e.7aac88","name":"Wandtaster Wohnzimmer?","property":"device_id","propertyType":"msg","rules":[{"t":"eq","v":"71a6e35835e3ac974599dcff07e671ff","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":360,"y":660,"wires":[["eaa3f2741baa2c7d"]]},{"id":"8fb984060706025c","type":"server-events","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":3,"exposeAsEntityConfig":"","eventType":"zwave_js_value_notification","waitForRunning":true,"outputProperties":[{"property":"node_id","propertyType":"msg","value":"$outputData(\"eventData\").event.node_id","valueType":"jsonata"},{"property":"device_id","propertyType":"msg","value":"$outputData(\"eventData\").event.device_id","valueType":"jsonata"},{"property":"key","propertyType":"msg","value":"$outputData(\"eventData\").event.property_key","valueType":"jsonata"},{"property":"value","propertyType":"msg","value":"$outputData(\"eventData\").event.value","valueType":"jsonata"}],"x":200,"y":740,"wires":[["72202d9b16981d7c"]]},{"id":"eaa3f2741baa2c7d","type":"function","z":"9bf7fb6e.7aac88","name":"generiere Tastendruck","func":"function status() {\n    var print = (s => (typeof s == \"string\") ? s : \"undefined\");\n    node.status({\"text\": `state: ${print(context.get(\"state\"))}, value: ${print(context.get(\"value\"))}, direction: ${print(context.get(\"direction\"))}, key: ${print(context.get(\"key\"))}`});\n}\n\nfunction setContext(key, value) {\n    context.set(key, value);\n    status();\n}\n\nfunction message (key) {\n    setContext(\"key\", key);\n    return {\"payload\": key};\n}\n\nif (msg.topic == \"state\") {\n    setContext(\"state\", msg.payload);\n    return;\n}\n\nvar state = context.get(\"state\");\nif (!state.match(\"^(on|off)$\")) {\n    return;\n}\n\nvar direction = context.get(\"direction\");\nvar value = msg.value;\nsetContext(\"value\", value);\nswitch (value) {\n    case \"KeyPressed\":\n        return message((state == \"on\") ? \"off-press\" : \"on-press\");\n    case \"KeyPressed2x\":\n        return message(\"on-press\");\n    case \"KeyHeldDown\":\n        return message(`${direction}-hold`);\n    case \"KeyReleased\":\n        setContext(\"direction\", direction == \"up\" ? \"down\" : \"up\");\n        return message(`${direction}-hold-release`);\n}\n","outputs":1,"noerr":0,"initialize":"function status() {\n    var print = (s => (typeof s == \"string\") ? s : \"undefined\");\n    node.status({\"text\": `state: ${print(context.get(\"state\"))}, value: ${print(context.get(\"value\"))}, direction: ${print(context.get(\"direction\"))}, key: ${print(context.get(\"key\"))}`});\n}\n\ncontext.set(\"state\", undefined);\ncontext.set(\"direction\", \"up\");\ncontext.set(\"value\", undefined);\ncontext.set(\"key\", undefined);\nstatus();","finalize":"","libs":[],"x":620,"y":660,"wires":[["e2c606c088b7a2f5"]]},{"id":"51eb7e5940b20171","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Licht Wohnzimmer","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.wohnzimmer","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"state","valueType":"str"}],"x":450,"y":600,"wires":[["eaa3f2741baa2c7d"]]},{"id":"b96304986ae5799d","type":"api-call-service","z":"9bf7fb6e.7aac88","name":"Schalter an","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"switch","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{switch}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":2130,"y":500,"wires":[["0ea45ed45f7f052d"]]},{"id":"903dfb0649325202","type":"change","z":"9bf7fb6e.7aac88","name":"Reset","rules":[{"t":"set","p":"reset","pt":"msg","to":"-2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":400,"wires":[["dcb91f9a8bdd378c"]]},{"id":"e99a925122131857","type":"switch","z":"9bf7fb6e.7aac88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on-press","vt":"str"},{"t":"eq","v":"off-press","vt":"str"},{"t":"regex","v":"(on|off)-hold.*","vt":"str","case":false},{"t":"regex","v":"(up|down)-.*","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":4,"x":1350,"y":520,"wires":[["dcb91f9a8bdd378c"],["0b39606137f3b53b"],["a6612ee84c8165b6"],["6fec77bf84b273af"]]},{"id":"36709a03fc5a1886","type":"switch","z":"9bf7fb6e.7aac88","name":"ON?","property":"count","propertyType":"msg","rules":[{"t":"gte","v":"-1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1610,"y":400,"wires":[["024f2e1ab29e5646"]]},{"id":"0b39606137f3b53b","type":"function","z":"9bf7fb6e.7aac88","name":"off-press","func":"var payload = {state: \"off\"};\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1620,"y":520,"wires":[["de0c260325a84190"]]},{"id":"a6612ee84c8165b6","type":"function","z":"9bf7fb6e.7aac88","name":"(on|off)-hold.*","func":"var payload = {\n    \"on-hold\": {color_temp_move: 60},\n    \"off-hold\": {color_temp_move: -60},\n    \"on-hold-release\": {color_temp_move: \"stop\"},\n    \"off-hold-release\": {color_temp_move: \"stop\"}\n}[msg.payload];\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1640,"y":560,"wires":[["de0c260325a84190"]]},{"id":"6fec77bf84b273af","type":"function","z":"9bf7fb6e.7aac88","name":"(up|down)-.*","func":"var payload = {\n    \"up-press\": {brightness_step: 40},\n    \"down-press\": {brightness_step: -40},\n    \"up-hold\": {brightness_move: 80},\n    \"down-hold\": {brightness_move: -80},\n    \"up-hold-release\": {brightness_move: \"stop\"},\n    \"down-hold-release\": {brightness_move: \"stop\"}\n}[msg.payload];\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1630,"y":600,"wires":[["de0c260325a84190"]]},{"id":"024f2e1ab29e5646","type":"function","z":"9bf7fb6e.7aac88","name":"on-press","func":"const startup_scene = {brightness: 254, color_temp: 370};\n\n// https://community.home-assistant.io/t/circadian-lighting-for-philips-hue-white-ambiance/84926\nconst additional_scenes = [\n    {brightness: 254, color_temp: 153} // Energize\n    , {brightness: 144, color_temp: 447} // Relax\n    , {brightness: 254, color_temp: 230} // Concentrate \n    , {brightness: 254, color_temp: 343} // Read\n] || []; // && to exclude, || to include additional scenes\n\nconst scenes = [\n    startup_scene\n    , ...additional_scenes\n];\n\nlet payload = (msg.count == -1) ? {state: \"on\"} : scenes[msg.count % scenes.length]; // round robin\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1620,"y":480,"wires":[["56c908eb76e35c0a"]]},{"id":"f8ce0fd5dfc0e129","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Arbeitszimmer","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.arbeitszimmer","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"arbeitszimmer","valueType":"str"}],"x":690,"y":160,"wires":[["6485f031a069570e"]]},{"id":"39ec7c2925e3806a","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Arbeitszimmer","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.arbeitszimmer_dimmer_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"arbeitszimmer","valueType":"str"}],"x":250,"y":160,"wires":[["96eee9d9afac6ecd"]]},{"id":"40f6105f1d42342b","type":"switch","z":"9bf7fb6e.7aac88","name":"hold?","property":"payload","propertyType":"msg","rules":[{"t":"regex","v":".*hold$","vt":"str","case":false},{"t":"neq","v":"","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":1090,"y":520,"wires":[["a36f5b01761a11f8"],["e99a925122131857"]]},{"id":"a36f5b01761a11f8","type":"rbe","z":"9bf7fb6e.7aac88","name":"","func":"rbe","gap":"","start":"","inout":"out","septopics":true,"property":"payload","topi":"room","x":1210,"y":480,"wires":[["e99a925122131857"]]},{"id":"4263e0699687a860","type":"mqtt out","z":"9bf7fb6e.7aac88","name":"","topic":"","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"dc1fcbdb1d762196","x":2310,"y":640,"wires":[]},{"id":"a82d4cbd50df8771","type":"api-current-state","z":"9bf7fb6e.7aac88","name":"Licht aus?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{light}}","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"light","propertyType":"msg","value":"","valueType":"triggerId"}],"for":"1","forType":"num","forUnits":"seconds","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":770,"y":1060,"wires":[["e8d46d88cfa0aebe"],[]]},{"id":"9021b8950eb82a44","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":3,"inputs":0,"outputs":2,"exposeAsEntityConfig":"","entityId":"switch.licht_arbeitszimmer","entityIdType":"exact","debugEnabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"customOutputs":[],"outputInitially":false,"enableInput":false,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"x":210,"y":860,"wires":[["8b8c5e79e40b176b"],[]]},{"id":"e8d46d88cfa0aebe","type":"api-call-service","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"switch","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{switch}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":940,"y":1060,"wires":[["9cf2bf8879ec350d"]]},{"id":"5202597b46f4358f","type":"api-current-state","z":"9bf7fb6e.7aac88","name":"Schalter an?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{switch}}","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"light","propertyType":"msg","value":"","valueType":"triggerId"}],"for":"1","forType":"num","forUnits":"seconds","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1970,"y":480,"wires":[["0ea45ed45f7f052d"],["b96304986ae5799d"]]},{"id":"fbf4c96dd0dc2446","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["0ea45ed45f7f052d","de0c260325a84190"],"x":2045,"y":640,"wires":[["65640ec49cb9ce31"]]},{"id":"0ea45ed45f7f052d","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["fbf4c96dd0dc2446"],"x":2235,"y":460,"wires":[]},{"id":"de0c260325a84190","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["fbf4c96dd0dc2446"],"x":1785,"y":560,"wires":[]},{"id":"d1868da58c58188a","type":"inject","z":"9bf7fb6e.7aac88","name":"Inject rooms","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"0","topic":"","payload":"{\"arbeitszimmer\":{\"switch\":\"switch.licht_arbeitszimmer\",\"light\":\"light.arbeitszimmer\",\"topic\":\"arbeitszimmer-deckenleuchte\"},\"kueche\":{\"switch\":\"switch.licht_kueche_2\",\"light\":\"light.kuche\",\"topic\":\"kueche-deckenleuchte\"},\"nino\":{\"switch\":\"switch.licht_nino\",\"light\":\"light.nino\",\"topic\":\"nino\"},\"noah\":{\"switch\":\"switch.licht_noah\",\"light\":\"light.noah\",\"topic\":\"noah\"},\"schlafzimmer\":{\"switch\":\"switch.licht_schlafzimmer\",\"light\":\"light.schlafzimmer\",\"topic\":\"schlafzimmer\"},\"wohnzimmer\":{\"switch\":\"switch.licht_wohnzimmer\",\"light\":\"light.wohnzimmer\",\"topic\":\"wohnzimmer\"}}","payloadType":"json","x":230,"y":60,"wires":[["37b4dabbce728f88"]]},{"id":"37b4dabbce728f88","type":"change","z":"9bf7fb6e.7aac88","name":"","rules":[{"t":"set","p":"#:(store)::rooms","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":60,"wires":[[]]},{"id":"c8ddb08d7c17a051","type":"change","z":"9bf7fb6e.7aac88","name":"setze msg.switch & msg.light","rules":[{"t":"set","p":"switch","pt":"msg","to":"$lookup(\t   $lookup(\t       $flowContext('rooms', 'store'),\t       msg.room\t   ),\t   'switch'\t)","tot":"jsonata"},{"t":"set","p":"light","pt":"msg","to":"$lookup(\t   $lookup(\t       $flowContext('rooms', 'store'),\t       msg.room\t   ),\t   'light'\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":980,"wires":[["a82d4cbd50df8771"]]},{"id":"8b8c5e79e40b176b","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"arbeitszimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":860,"wires":[["3d5ca12ff218d542"]]},{"id":"96eee9d9afac6ecd","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["15de1c31bfbbd7af","75fe50d8b23b078c","2092a9e88d2690e4"],"x":415,"y":320,"wires":[]},{"id":"15de1c31bfbbd7af","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["96eee9d9afac6ecd","63841c973ad2716a"],"x":1005,"y":520,"wires":[["40f6105f1d42342b"]]},{"id":"9cf2bf8879ec350d","type":"api-call-service","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{light}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1110,"y":1060,"wires":[[]]},{"id":"84900d20942bac03","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":3,"inputs":0,"outputs":2,"exposeAsEntityConfig":"","entityId":"switch.licht_schlafzimmer","entityIdType":"exact","debugEnabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"customOutputs":[],"outputInitially":false,"enableInput":false,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"x":210,"y":920,"wires":[["238028061159925e"],[]]},{"id":"238028061159925e","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"schlafzimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":920,"wires":[["3d5ca12ff218d542"]]},{"id":"b5356def0be59eb9","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Schlafzimmer Bella","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.schlafzimmer_dimmer_bella_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"schlafzimmer","valueType":"str"}],"x":230,"y":280,"wires":[["96eee9d9afac6ecd"]]},{"id":"9476d61d47d3fba6","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Schlafzimmer Jan","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.schlafzimmer_dimmer_jan_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"schlafzimmer","valueType":"str"}],"x":230,"y":340,"wires":[["96eee9d9afac6ecd"]]},{"id":"3d5ca12ff218d542","type":"change","z":"9bf7fb6e.7aac88","name":"lösche Rest","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"delete","p":"topic","pt":"msg"},{"t":"delete","p":"data","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":980,"wires":[["c8ddb08d7c17a051"]]},{"id":"dcb91f9a8bdd378c","type":"function","z":"9bf7fb6e.7aac88","name":"Counter per room","func":"counters = context.get(\"counters\");\nvar room = msg.room;\n\ncounters[room] = (\"reset\" in msg) ? -2 : (room in counters ? counters[room] : -2) + 1;\nmsg.count = counters[room];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"context.set(\"counters\", {});","finalize":"","libs":[],"x":1450,"y":400,"wires":[["36709a03fc5a1886"]]},{"id":"36f9e5b9c8484459","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Schlafzimmer","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.schlafzimmer","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"schlafzimmer","valueType":"str"}],"x":690,"y":220,"wires":[["6485f031a069570e"]]},{"id":"56c908eb76e35c0a","type":"change","z":"9bf7fb6e.7aac88","name":"","rules":[{"t":"set","p":"switch","pt":"msg","to":"$lookup(\t   $lookup(\t       $flowContext('rooms', 'store'),\t       msg.room\t   ),\t   'switch'\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1790,"y":480,"wires":[["5202597b46f4358f"]]},{"id":"65640ec49cb9ce31","type":"change","z":"9bf7fb6e.7aac88","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"$join(\t   [\t       'zigbee2mqtt/',\t       $lookup(\t           $lookup(\t               $flowContext('rooms', 'store'),\t               msg.room\t   ),\t           'topic'\t),\t       '/set'\t   ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":640,"wires":[["4263e0699687a860","5265d1f4affb8841"]]},{"id":"ab2fecd248024105","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["f21a5f7335339be9"],"x":1185,"y":400,"wires":[["903dfb0649325202"]]},{"id":"f21a5f7335339be9","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["ab2fecd248024105"],"x":975,"y":300,"wires":[]},{"id":"bafd6d2798787d01","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":3,"inputs":0,"outputs":2,"exposeAsEntityConfig":"","entityId":"switch.licht_kueche_2","entityIdType":"exact","debugEnabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"new_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"old_state.state"}],"customOutputs":[],"outputInitially":false,"enableInput":false,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"x":220,"y":980,"wires":[["02f7e42f1ba6d796"],[]]},{"id":"02f7e42f1ba6d796","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"kueche","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":980,"wires":[["3d5ca12ff218d542"]]},{"id":"e9f12d6e90657db6","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Küche","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.kuche","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"kueche","valueType":"str"}],"x":710,"y":280,"wires":[["6485f031a069570e"]]},{"id":"14d9ee980a59c8fa","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Küche","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.kueche_dimmer_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"kueche","valueType":"str"}],"x":270,"y":220,"wires":[["96eee9d9afac6ecd"]]},{"id":"820a0701c18ca170","type":"comment","z":"9bf7fb6e.7aac88","name":"Dimmer","info":"","x":450,"y":240,"wires":[]},{"id":"950819b281f30f29","type":"comment","z":"9bf7fb6e.7aac88","name":"Licht","info":"","x":930,"y":220,"wires":[]},{"id":"6485f031a069570e","type":"switch","z":"9bf7fb6e.7aac88","name":"off?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":890,"y":300,"wires":[["f21a5f7335339be9"]]},{"id":"5265d1f4affb8841","type":"debug","z":"9bf7fb6e.7aac88","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2310,"y":600,"wires":[]},{"id":"8ce53f84bdcfbf1c","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":3,"inputs":0,"outputs":2,"exposeAsEntityConfig":"","entityId":"switch.licht_nino","entityIdType":"exact","debugEnabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"customOutputs":[],"outputInitially":false,"enableInput":false,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"x":240,"y":1040,"wires":[["620b0b5ae0673ac5"],[]]},{"id":"620b0b5ae0673ac5","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"nino","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":1040,"wires":[["3d5ca12ff218d542"]]},{"id":"8267de4b355e9290","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Nino","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.nino","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"nino","valueType":"str"}],"x":710,"y":340,"wires":[["6485f031a069570e"]]},{"id":"033ec9119641a670","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Nino","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.nino_dimmer_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"nino","valueType":"str"}],"x":270,"y":400,"wires":[["96eee9d9afac6ecd"]]},{"id":"d5f530707ef32996","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Noah","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.noah","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"noah","valueType":"str"}],"x":710,"y":400,"wires":[["6485f031a069570e"]]},{"id":"920b1fde95f21d31","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Noah","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.noah_dimmer_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"noah","valueType":"str"}],"x":270,"y":460,"wires":[["96eee9d9afac6ecd"]]},{"id":"5a9b1cbde77aeea5","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":3,"inputs":0,"outputs":2,"exposeAsEntityConfig":"","entityId":"switch.licht_noah","entityIdType":"exact","debugEnabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"customOutputs":[],"outputInitially":false,"enableInput":false,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"x":230,"y":1100,"wires":[["8efd63d256968dd8"],[]]},{"id":"8efd63d256968dd8","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"noah","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":1100,"wires":[["3d5ca12ff218d542"]]},{"id":"63841c973ad2716a","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["15de1c31bfbbd7af","75fe50d8b23b078c","2092a9e88d2690e4"],"x":915,"y":660,"wires":[]},{"id":"08179cb82cfbcd95","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Wohnzimmer","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"light.wohnzimmer","entityIdType":"exact","outputInitially":true,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"wohnzimmer","valueType":"str"}],"x":690,"y":460,"wires":[["6485f031a069570e"]]},{"id":"137007d599a02ece","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Wohnzimmer","server":"a0992e23.0acf8","version":5,"outputs":1,"exposeAsEntityConfig":"","entityId":"sensor.wohnzimmer_dimmer_action","entityIdType":"exact","outputInitially":false,"stateType":"str","ifState":"","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"wohnzimmer","valueType":"str"}],"x":250,"y":520,"wires":[["96eee9d9afac6ecd"]]},{"id":"e2c606c088b7a2f5","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"wohnzimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":660,"wires":[["63841c973ad2716a"]]},{"id":"44a20062731a4a0e","type":"comment","z":"9bf7fb6e.7aac88","name":"Konfiguration","info":"","x":630,"y":60,"wires":[]},{"id":"b326206678251299","type":"comment","z":"9bf7fb6e.7aac88","name":"Dimmer (Wandtaster)","info":"","x":220,"y":600,"wires":[]},{"id":"bbcc6a4694801bb8","type":"comment","z":"9bf7fb6e.7aac88","name":"Wandschalter aus, wenn Licht aus (→ einschalten!)","info":"","x":790,"y":900,"wires":[]},{"id":"c99ba34d9419d2c1","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["72202d9b16981d7c"],"x":205,"y":660,"wires":[["c1468a42eea018f0"]]},{"id":"72202d9b16981d7c","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["c99ba34d9419d2c1"],"x":375,"y":740,"wires":[]},{"id":"3e5dcf464cb35452","type":"api-call-service","z":"f2681015255691ca","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"notify","service":"all_mobiles","areaId":[],"deviceId":[],"entityId":[],"data":"{\"title\": \"Waschmaschine fertig!\", \"message\": \"Du kannst sie nun ausräumen.\"}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1090,"y":200,"wires":[[]]},{"id":"bb5c32f0f1321f95","type":"switch","z":"f2681015255691ca","name":"","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"3","vt":"num"},{"t":"gt","v":"0.5","vt":"num"},{"t":"gte","v":"0","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":230,"y":200,"wires":[["3b5f092aea904e06"],["ac2d58804b5fc509"],["61e6992feec7f57d"],["d0a2fa35762e64db"]]},{"id":"3b5f092aea904e06","type":"change","z":"f2681015255691ca","name":"running","rules":[{"t":"set","p":"payload","pt":"msg","to":"running","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":140,"wires":[["720f80fd3f170dd3"]]},{"id":"ac2d58804b5fc509","type":"change","z":"f2681015255691ca","name":"standby","rules":[{"t":"set","p":"payload","pt":"msg","to":"standby","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":180,"wires":[["720f80fd3f170dd3"]]},{"id":"61e6992feec7f57d","type":"change","z":"f2681015255691ca","name":"off","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":220,"wires":[["720f80fd3f170dd3"]]},{"id":"720f80fd3f170dd3","type":"state-machine","z":"f2681015255691ca","name":"Status","triggerProperty":"payload","triggerPropertyType":"msg","stateProperty":"payload","statePropertyType":"msg","initialDelay":"0","persistOnReload":false,"outputStateChangeOnly":false,"throwException":false,"states":["start","aus","wartet","arbeitet","fertig"],"transitions":[{"name":"running","from":"*","to":"arbeitet"},{"name":"standby","from":"arbeitet","to":"fertig"},{"name":"standby","from":"fertig","to":"fertig"},{"name":"standby","from":"*","to":"wartet"},{"name":"off","from":"*","to":"aus"}],"x":550,"y":200,"wires":[["660df2ca0d1fc17b"]]},{"id":"e3a74ca9c923f18a","type":"switch","z":"f2681015255691ca","name":"fertig?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"fertig","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":930,"y":200,"wires":[["3e5dcf464cb35452"]]},{"id":"e799b506a5f74ddb","type":"link in","z":"f2681015255691ca","name":"","links":["9ab2798660f05b4a","ee3d77ef2ddd8263","657dbd9402935009"],"x":145,"y":200,"wires":[["bb5c32f0f1321f95"]]},{"id":"657dbd9402935009","type":"link out","z":"f2681015255691ca","name":"","mode":"link","links":["53911cca546ed47a","e799b506a5f74ddb"],"x":605,"y":80,"wires":[]},{"id":"cdf8f935c29e0d78","type":"link out","z":"f2681015255691ca","name":"","mode":"link","links":["f5c30f1d88eaa105"],"x":755,"y":200,"wires":[]},{"id":"f5c30f1d88eaa105","type":"link in","z":"f2681015255691ca","name":"","links":["9ab2798660f05b4a","cdf8f935c29e0d78"],"x":825,"y":140,"wires":[["e3a74ca9c923f18a","a6febb625684b60c"]]},{"id":"660df2ca0d1fc17b","type":"rbe","z":"f2681015255691ca","name":"","func":"rbei","gap":"","start":"","inout":"out","septopics":false,"property":"payload","topi":"topic","x":670,"y":200,"wires":[["cdf8f935c29e0d78"]]},{"id":"d5f819b4e7854c9d","type":"poll-state","z":"f2681015255691ca","name":"Waschmaschine: Leistung","server":"a0992e23.0acf8","version":3,"exposeAsEntityConfig":"","updateInterval":"10","updateIntervalType":"num","updateIntervalUnits":"seconds","outputInitially":true,"outputOnChanged":false,"entityId":"sensor.steckdose_waschmaschine_power","stateType":"num","ifState":"","ifStateType":"str","ifStateOperator":"is","outputs":1,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":150,"y":40,"wires":[["258e9ad866ea0af4"]]},{"id":"258e9ad866ea0af4","type":"function","z":"f2681015255691ca","name":"time-weighted average (over 180s)","func":"/*\ntime-weighted average of payload values\nover the specified time range (in ms)\n*/\nconst range = 180 * 1000;\n\nlet now = Date.now();\n\nfunction reset () {\n    context.set('t', undefined);\n    context.set('T', 0);\n    context.set('F', 0);\n    context.set('buffer', []);\n}\n\nlet f = Number(msg.payload);\nif (Number.isNaN(f)) {\n    reset();\n    return {'payload': 'unknown'};\n}\n\nif (context.get('buffer') == undefined) {\n    reset();\n}\n\nlet t = context.get('t') || now - range;\nlet T = context.get('T');\nlet F = context.get('F');\nlet buffer = context.get('buffer');\n\nlet dt = now - t;\nlet increment = {dt: dt, df: f * dt};\n\nT += increment.dt;\nF += increment.df;\nbuffer.push(increment);\n\nwhile ((T - buffer[0].dt) >= range) {\n  T -= buffer[0].dt;\n  F -= buffer[0].df;\n  buffer.shift();\n}\n\ncontext.set('t', now);\ncontext.set('T', T);\ncontext.set('F', F);\ncontext.set('buffer', buffer);\n\nmsg.payload = Number((F / T).toFixed(1));\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"// Der Code hier wird ausgeführt,\n// wenn der Node gestartet wird\n\ncontext.set('buffer', undefined);\n","finalize":"","libs":[],"x":420,"y":40,"wires":[["657dbd9402935009","4cf4371f25cf16f2"]]},{"id":"d0a2fa35762e64db","type":"change","z":"f2681015255691ca","name":"unknown","rules":[{"t":"set","p":"payload","pt":"msg","to":"unknown","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":260,"wires":[["720f80fd3f170dd3"]]},{"id":"a6febb625684b60c","type":"ha-sensor","z":"f2681015255691ca","name":"Waschmaschine: Status","entityConfig":"47d0b5d7940e7cf8","version":0,"state":"payload","stateType":"msg","attributes":[],"inputOverride":"allow","outputProperties":[],"x":990,"y":140,"wires":[[]]},{"id":"4cf4371f25cf16f2","type":"ha-sensor","z":"f2681015255691ca","name":"Waschmaschine: mittlere Leistung","entityConfig":"14c2b510a5d538ec","version":0,"state":"payload","stateType":"msg","attributes":[],"inputOverride":"allow","outputProperties":[],"x":760,"y":40,"wires":[[]]},{"id":"8f093561d83b4adf","type":"api-call-service","z":"e12ba8ee5e5db754","name":"turn off","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"switch","service":"turn_off","areaId":[],"deviceId":[],"entityId":["{{ switch }}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1360,"y":300,"wires":[["fe4a506aecbc2157"]]},{"id":"d742199e578d2909","type":"ha-wait-until","z":"e12ba8ee5e5db754","name":"power > threshold within timeout?","server":"a0992e23.0acf8","version":2,"outputs":2,"entityId":"{{ sensor }}","entityIdFilterType":"exact","property":"state","comparator":"gt","value":"0","valueType":"num","timeout":"60","timeoutType":"num","timeoutUnits":"minutes","checkCurrentState":true,"blockInputOverrides":false,"outputProperties":[],"entityLocation":"data","entityLocationType":"none","x":840,"y":300,"wires":[["839cc80421429c39"],["f0d72b9e69fb9eab"]]},{"id":"6de78bde9a16f03e","type":"inject","z":"e12ba8ee5e5db754","name":"switches","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"15","topic":"","payload":"{\"arbeitszimmer\":{\"switch\":\"switch.steckdose_arbeitszimmer_switch\",\"sensor\":\"sensor.steckdose_arbeitszimmer_power\"},\"garage\":{\"switch\":\"switch.steckdose_garage_switch\",\"sensor\":\"sensor.steckdose_garage_power\"},\"keller\":{\"switch\":\"switch.steckdose_keller_switch\",\"sensor\":\"sensor.steckdose_keller_power\"}}","payloadType":"json","x":120,"y":120,"wires":[["378b2035f246c655"]]},{"id":"a03106ad17bdf64a","type":"api-current-state","z":"e12ba8ee5e5db754","name":"switch on?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ switch }}","state_type":"str","blockInputOverrides":true,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1210,"y":300,"wires":[["8f093561d83b4adf"],["fe4a506aecbc2157"]]},{"id":"31b1bd1c080a7f9e","type":"api-current-state","z":"e12ba8ee5e5db754","name":"read timeout","server":"a0992e23.0acf8","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ input_timeout }}","state_type":"num","blockInputOverrides":true,"outputProperties":[{"property":"payload.timeout","propertyType":"msg","value":"","valueType":"entityState"}],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":430,"y":300,"wires":[["268f81fa93ab284b"]]},{"id":"268f81fa93ab284b","type":"api-current-state","z":"e12ba8ee5e5db754","name":"read threshold","server":"a0992e23.0acf8","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ input_threshold }}","state_type":"num","blockInputOverrides":true,"outputProperties":[{"property":"payload.value","propertyType":"msg","value":"","valueType":"entityState"}],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":600,"y":300,"wires":[["d742199e578d2909"]]},{"id":"f98432105e624ad1","type":"link in","z":"e12ba8ee5e5db754","name":"link in 3","links":["19d91c5475c3ebed","025e2fb6e8558165","fe4a506aecbc2157","46023dba7981930c","a0111a6c0b39ced1","c3b29c1786a0233e","a08aad5c3adaeb86","5cbffc78142f842d"],"x":165,"y":340,"wires":[["cad32e64dd966e75"]]},{"id":"19d91c5475c3ebed","type":"link out","z":"e12ba8ee5e5db754","name":"link out 4","mode":"link","links":["f98432105e624ad1"],"x":595,"y":120,"wires":[]},{"id":"3c7306ec95013274","type":"change","z":"e12ba8ee5e5db754","name":"set static parameters","rules":[{"t":"delete","p":"parts","pt":"msg"},{"t":"set","p":"switch","pt":"msg","to":"payload.switch","tot":"msg"},{"t":"set","p":"sensor","pt":"msg","to":"payload.sensor","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"input_active","pt":"msg","to":"\"input_boolean.switch_auto_off_active_\" & $.label","tot":"jsonata"},{"t":"set","p":"input_timeout","pt":"msg","to":"\"input_number.switch_auto_off_timeout_\" & $.label","tot":"jsonata"},{"t":"set","p":"input_threshold","pt":"msg","to":"\"input_number.switch_auto_off_threshold_\" & $.label","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":120,"wires":[["19d91c5475c3ebed"]]},{"id":"cad32e64dd966e75","type":"switch","z":"e12ba8ee5e5db754","name":"label?","property":"label","propertyType":"msg","rules":[{"t":"eq","v":"arbeitszimmer","vt":"str"},{"t":"eq","v":"garage","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":250,"y":340,"wires":[["31b1bd1c080a7f9e"],["f83a31e625c9a48a"]]},{"id":"fe4a506aecbc2157","type":"link out","z":"e12ba8ee5e5db754","name":"link out 6","mode":"link","links":["f98432105e624ad1"],"x":1455,"y":300,"wires":[]},{"id":"f0d72b9e69fb9eab","type":"api-current-state","z":"e12ba8ee5e5db754","name":"active?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ input_active }}","state_type":"str","blockInputOverrides":true,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1060,"y":300,"wires":[["a03106ad17bdf64a"],["fe4a506aecbc2157"]]},{"id":"378b2035f246c655","type":"split","z":"e12ba8ee5e5db754","name":"split labels","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"label","x":270,"y":120,"wires":[["3c7306ec95013274"]]},{"id":"89f3a1166b406b9e","type":"comment","z":"e12ba8ee5e5db754","name":"arbeitszimmer","info":"","x":1570,"y":300,"wires":[]},{"id":"dde7bc9e42ae39dd","type":"comment","z":"e12ba8ee5e5db754","name":"garage","info":"","x":1550,"y":400,"wires":[]},{"id":"767261c5ad6f5cfb","type":"trigger","z":"e12ba8ee5e5db754","name":"","op1":"","op2":"","op1type":"nul","op2type":"payl","duration":"1","extend":false,"overrideDelay":false,"units":"min","reset":"","bytopic":"topic","topic":"label","outputs":1,"x":270,"y":180,"wires":[["a08aad5c3adaeb86"]]},{"id":"839cc80421429c39","type":"link out","z":"e12ba8ee5e5db754","name":"link out 7","mode":"link","links":["31898cce77fbf9cc"],"x":1005,"y":260,"wires":[]},{"id":"31898cce77fbf9cc","type":"link in","z":"e12ba8ee5e5db754","name":"link in 4","links":["839cc80421429c39","0f0181706d453dbb"],"x":165,"y":180,"wires":[["767261c5ad6f5cfb"]]},{"id":"a08aad5c3adaeb86","type":"link out","z":"e12ba8ee5e5db754","name":"link out 8","mode":"link","links":["f98432105e624ad1"],"x":375,"y":180,"wires":[]},{"id":"7b11cd4e3bc9958e","type":"api-call-service","z":"e12ba8ee5e5db754","name":"turn off","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"switch","service":"turn_off","areaId":[],"deviceId":[],"entityId":["{{ switch }}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1360,"y":400,"wires":[["5cbffc78142f842d"]]},{"id":"0f9870e126b44ce5","type":"ha-wait-until","z":"e12ba8ee5e5db754","name":"power > threshold within timeout?","server":"a0992e23.0acf8","version":2,"outputs":2,"entityId":"{{ sensor }}","entityIdFilterType":"exact","property":"state","comparator":"gt","value":"0","valueType":"num","timeout":"60","timeoutType":"num","timeoutUnits":"minutes","checkCurrentState":true,"blockInputOverrides":false,"outputProperties":[],"entityLocation":"data","entityLocationType":"none","x":840,"y":400,"wires":[["0f0181706d453dbb"],["4a9badf7efac6dfa"]]},{"id":"d7d96af54e1057ce","type":"api-current-state","z":"e12ba8ee5e5db754","name":"switch on?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ switch }}","state_type":"str","blockInputOverrides":true,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1210,"y":400,"wires":[["7b11cd4e3bc9958e"],["5cbffc78142f842d"]]},{"id":"f83a31e625c9a48a","type":"api-current-state","z":"e12ba8ee5e5db754","name":"read timeout","server":"a0992e23.0acf8","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ input_timeout }}","state_type":"num","blockInputOverrides":true,"outputProperties":[{"property":"payload.timeout","propertyType":"msg","value":"","valueType":"entityState"}],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":430,"y":400,"wires":[["a0d9dbfdaa8ef183"]]},{"id":"a0d9dbfdaa8ef183","type":"api-current-state","z":"e12ba8ee5e5db754","name":"read threshold","server":"a0992e23.0acf8","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ input_threshold }}","state_type":"num","blockInputOverrides":true,"outputProperties":[{"property":"payload.value","propertyType":"msg","value":"","valueType":"entityState"}],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":600,"y":400,"wires":[["0f9870e126b44ce5"]]},{"id":"5cbffc78142f842d","type":"link out","z":"e12ba8ee5e5db754","name":"link out 9","mode":"link","links":["f98432105e624ad1"],"x":1455,"y":400,"wires":[]},{"id":"4a9badf7efac6dfa","type":"api-current-state","z":"e12ba8ee5e5db754","name":"active?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{ input_active }}","state_type":"str","blockInputOverrides":true,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1060,"y":400,"wires":[["d7d96af54e1057ce"],["5cbffc78142f842d"]]},{"id":"0f0181706d453dbb","type":"link out","z":"e12ba8ee5e5db754","name":"link out 10","mode":"link","links":["31898cce77fbf9cc"],"x":1005,"y":360,"wires":[]}]