[{"id":"79ddab3e.2ca0c4","type":"tab","label":"Rolladensteuerung","disabled":false,"info":""},{"id":"e6cb2a0bf9f73b5e","type":"tab","label":"Lichtkuppelsteuerung","disabled":false,"info":"","env":[]},{"id":"9bf7fb6e.7aac88","type":"tab","label":"Beleuchtung","disabled":false,"info":""},{"id":"6dc4c1678ae71fb6","type":"tab","label":"Heizung","disabled":false,"info":"","env":[]},{"id":"f2681015255691ca","type":"tab","label":"Waschmaschine","disabled":false,"info":"","env":[]},{"id":"edc1527de2d701a7","type":"tab","label":"Scratchbook","disabled":false,"info":""},{"id":"a0992e23.0acf8","type":"server","name":"Home Assistant","version":2,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true,"heartbeat":false,"heartbeatInterval":30},{"id":"a962ddc.fbff22","type":"position-config","name":"Kostheimer Landstraße 17, 55246 Mainz-Kostheim","isValide":"true","longitude":"0","latitude":"0","angleType":"deg","timeZoneOffset":99,"timeZoneDST":0,"stateTimeFormat":"3","stateDateFormat":"12","contextStore":""},{"id":"dc1fcbdb1d762196","type":"mqtt-broker","name":"","broker":"core-mosquitto","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"6f4e279d.892e58","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sonnenstandsteuerung","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_select.blind_control_mode_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"mode","valueType":"str"}],"x":2380,"y":940,"wires":[["59ef0664.5b1bf8"]]},{"id":"1151bc6f.c175d4","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Werktag (heute)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.is_workday_today","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":2400,"y":460,"wires":[["30aa6cf2.546b44"]]},{"id":"30aa6cf2.546b44","type":"change","z":"79ddab3e.2ca0c4","name":"flow.dayInfo.today.isWorkday","rules":[{"t":"set","p":"#:(store)::dayInfo.today.isWorkday","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2660,"y":460,"wires":[[]]},{"id":"b6fe5f32.faeab","type":"change","z":"79ddab3e.2ca0c4","name":"flow.dayInfo.tomorrow.isWorkday","rules":[{"t":"set","p":"#:(store)::dayInfo.tomorrow.isWorkday","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2680,"y":520,"wires":[[]]},{"id":"edb8b9f2.f56048","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Werktag (morgen)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.is_workday_tomorrow","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":2390,"y":520,"wires":[["b6fe5f32.faeab"]]},{"id":"8651207e.ecb56","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"frühestens von (Werktag)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_datetime.blind_control_from_earliest_workday_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"fromEarliestWorkday","valueType":"str"}],"x":2370,"y":1000,"wires":[["eeb04577.e27bc8"]]},{"id":"3116bee7.185eb2","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"spätestens bis (Werktag)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_datetime.blind_control_until_latest_workday_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"untilLatestWorkday","valueType":"str"}],"x":2370,"y":1060,"wires":[["143cec6e.e94174"]]},{"id":"601d4000.d7862","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"frühestens von (Feiertag)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_datetime.blind_control_from_earliest_holiday_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"fromEarliestHoliday","valueType":"str"}],"x":2370,"y":1120,"wires":[["9553c3af.b4e0e"]]},{"id":"ee2d0a99.94f108","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"spätestens bis (Feiertag)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_datetime.blind_control_until_latest_holiday_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"untilLatestHoliday","valueType":"str"}],"x":2370,"y":1180,"wires":[["5e4ed2ae.35d29c"]]},{"id":"e3e74aca.2ae0c8","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.wohnzimmer', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1660,"wires":[["647d9e4d.7cdbb","16575c7735cc6c0d"]]},{"id":"b7461eaa.f9dbc","type":"debug","z":"79ddab3e.2ca0c4","name":"Steuerung","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3390,"y":200,"wires":[]},{"id":"39dea74a.5370c8","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.wohnzimmer', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1600,"wires":[["5154f42.a7cb10c","4ca41dc63c2fde47"]]},{"id":"7d8da7cc.3697e8","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.schlafzimmer', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1860,"wires":[["278c67c7.27e608","b334a48464a76b79"]]},{"id":"7d786999.13a9f8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Höchsttemperatur (Vorhersage)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.weather_forecast_temperature_high","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"temperatureMax","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2350,"y":1440,"wires":[["fd04dc1.3be172"]]},{"id":"5b82690d.e999e8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Tiefsttemperatur (Vorhersage)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.weather_forecast_temperature_low","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"temperatureMin","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2360,"y":1500,"wires":[["fd04dc1.3be172"]]},{"id":"385c87d5.6c0e88","type":"switch","z":"79ddab3e.2ca0c4","name":"temperature < 17 °C?","property":"payload.temperature","propertyType":"msg","rules":[{"t":"lt","v":"17","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2640,"y":1760,"wires":[["f44628aa.f71908"],["c0aec1de.9be17"]]},{"id":"c4a66df1.cec7d","type":"switch","z":"79ddab3e.2ca0c4","name":"temperatureMin < –5 °C?","property":"payload.temperatureMin","propertyType":"msg","rules":[{"t":"lt","v":"-5","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2650,"y":1640,"wires":[["e63204c4232f5c0f"],["2f712298.10c6be"]]},{"id":"c0aec1de.9be17","type":"switch","z":"79ddab3e.2ca0c4","name":"solarPowerNextHour < 200 W?","property":"payload.solarPowerNextHour","propertyType":"msg","rules":[{"t":"lt","v":"200","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2670,"y":1820,"wires":[["f44628aa.f71908"],["bed79daf.c6b7d"]]},{"id":"d3845079.e7563","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Automatik Sonnenstandsteuerung","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_boolean.blind_control_auto_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"auto","valueType":"str"}],"x":2340,"y":880,"wires":[["59d10a57.ef1e54"]]},{"id":"fd04dc1.3be172","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":2590,"y":1480,"wires":[["b9231714.1f2478"]]},{"id":"b9231714.1f2478","type":"switch","z":"79ddab3e.2ca0c4","name":"vollständig?","property":"$count($keys(msg.payload)) = 4","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":2730,"y":1480,"wires":[["61b62ef1.adae4"]]},{"id":"f44628aa.f71908","type":"change","z":"79ddab3e.2ca0c4","name":"aus","rules":[{"t":"set","p":"mode","pt":"msg","to":"aus","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1720,"wires":[["761423cd.d3881c"]]},{"id":"7936bb15.899f44","type":"change","z":"79ddab3e.2ca0c4","name":"Winter","rules":[{"t":"set","p":"mode","pt":"msg","to":"Winter","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1640,"wires":[["761423cd.d3881c"]]},{"id":"bed79daf.c6b7d","type":"change","z":"79ddab3e.2ca0c4","name":"Sommer","rules":[{"t":"set","p":"mode","pt":"msg","to":"Sommer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3140,"y":1800,"wires":[["761423cd.d3881c"]]},{"id":"1db35bfa.d0aa34","type":"api-call-service","z":"79ddab3e.2ca0c4","name":"setze Schalter","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"{{domain}}","service":"{{service}}","areaId":[],"deviceId":[],"entityId":["{{entity_id}}"],"data":"msg.data","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":3980,"y":560,"wires":[[]]},{"id":"ce0e9316.3ec58","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sonnenleistung (nächste Stunde)","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.power_production_next_hour","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"solarPowerNextHour","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2350,"y":1380,"wires":[["fd04dc1.3be172"]]},{"id":"61b62ef1.adae4","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1480,"wires":[["c4a66df1.cec7d"]]},{"id":"175fcd54.ff9613","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_sensor_terrasse_access_control_door_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1660,"wires":[["7a8ae7b.f6d2418"]]},{"id":"76e1cfbd.5e675","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["bf339f52.8d3c3","eb4d638e.59791","ba177608.e92ab8","dd7c30f0.2eb05","be200807.b749a8","661839b6.633208","a1ae5ee8.854af","c188372f.98fd48","d49691fd.0934f","3dd26aec.942b06","95d229d3.7c7388","3ad59bfd.393924","e4f75033.5104a","2f4137b4.c4b378","6aefb8a1.904188","e52c7c5.cdae08","fc9c88a6.86e0d8","a0a23d41.66767","405db6c2.e8e7b8","f6b52548.51de08","4311b1da.6fb3d","919d6b96.053878","766c8887.e38e78","e5d34195.e1dbd","63916888.267688","14f40dc0.294162","be7ad3c4.d4286","cd3ac6f9.3d2558","b1b8e0d6.83f92","42c34c14.ad5d94","845c5fe1.7c90b","5b81bd3d.5a99c4","902b3788.3b5bb8","99c6882.54cde78","e9b0bfd7.1a1b3","2e93feda.d44822"],"x":135,"y":160,"wires":[]},{"id":"e0d80bf0.6f4108","type":"comment","z":"79ddab3e.2ca0c4","name":"Trigger","info":"","x":2270,"y":80,"wires":[]},{"id":"6b112f75.88842","type":"comment","z":"79ddab3e.2ca0c4","name":"Kontext","info":"","x":2270,"y":380,"wires":[]},{"id":"c3a214dc.3e49f8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_wohnzimmer_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1480,"wires":[["f48275fc.3b24f8"]]},{"id":"4d971092.e14ef","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.wohnzimmer', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1480,"wires":[["c1bef3e9.5100d","46e7518f5cf3a73c"]]},{"id":"e793a7c0.212528","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_kueche_links_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1280,"wires":[["ed068856.607ad8"]]},{"id":"9d69a582.3d4b98","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.kueche', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1280,"wires":[["5ee9b008.5f4d7","f30c64467d309263"]]},{"id":"adcc7c38.74e0a","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.kueche', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1220,"wires":[["22015346.7f02bc","a52a9b6776be398b"]]},{"id":"c9db3695.83a1a8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_kueche_rechts_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1220,"wires":[["f08ac1a8.b9091"]]},{"id":"51bf045.f7b99fc","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_badezimmer_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":240,"wires":[["83f37a28.e1a038"]]},{"id":"8719beb2.469b","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.badezimmer', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":240,"wires":[["562f46a8.2ca9a8","e3a7303ba129b85d"]]},{"id":"5577b3ee.823b5c","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_duschbad_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":400,"wires":[["b84086f8.fd1638"]]},{"id":"f82044.38329fc","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.duschbad', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":400,"wires":[["56013b77.0255c4","a97f891155a24fe3"]]},{"id":"17fd404f.efe5d","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.nino', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":620,"wires":[["bec27538.788338","d3d128cf86485fe9"]]},{"id":"b52cb0a1.382cb","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":"$flowContext('alert', 'store') or $flowContext('options.active.nino', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":560,"wires":[["53ef1349.0cc05c","ae24157bbcb644ae"]]},{"id":"bc8663a5.9c478","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_arbeitszimmer_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1080,"wires":[["b8bd6d70.5c8d3"]]},{"id":"3e1b19ef.ad6db6","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.arbeitszimmer', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":1080,"wires":[["80693c86.251eb","48110af5440c3632"]]},{"id":"2d808d1e.af01b2","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_noah_links_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":880,"wires":[["6c4f0fcd.c6b12"]]},{"id":"e0506eb0.24dc7","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.noah', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":880,"wires":[["6bc48c93.4fa614","3e60f5e82daa1b07"]]},{"id":"276e7b69.24efd4","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv oder Alert/Override?","property":" $flowContext('alert', 'store') or $flowContext('options.active.noah', 'store') or msg.blindCtrl.blind.overwrite.active","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":970,"y":820,"wires":[["491d4a0b.61f174","eaa4cef39e9e250d"]]},{"id":"b446f873.d01658","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung aktiv","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_boolean.blind_control_active_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"active","valueType":"str"}],"x":2370,"y":820,"wires":[["d4b93fb1.ba853"]]},{"id":"d4b93fb1.ba853","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":820,"wires":[["5bf5ee73.f906"]]},{"id":"e06d988b.f45608","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":940,"wires":[["c715ba47.4785c8"]]},{"id":"c715ba47.4785c8","type":"switch","z":"79ddab3e.2ca0c4","name":"vollständig?","property":"$count($keys(msg.payload)) = $count($flowContext(\"rooms\", \"store\"))","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":3010,"y":940,"wires":[["5c995479.83034c"]]},{"id":"a7fe70e9.87fac","type":"change","z":"79ddab3e.2ca0c4","name":"triggerOnly","rules":[{"t":"set","p":"topic","pt":"msg","to":"triggerOnly","tot":"str"},{"t":"set","p":"room","pt":"msg","to":"global","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3110,"y":140,"wires":[["3b2457f4.7bf708"]]},{"id":"b73c2ea3.ec314","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung gesondert je Raum","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_boolean.blind_control_specific_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"specific","valueType":"str"}],"x":2330,"y":700,"wires":[["e1077381.aabae"]]},{"id":"e1077381.aabae","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":700,"wires":[["1fafbd65.55bab3"]]},{"id":"59ef0664.5b1bf8","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":940,"wires":[["e06d988b.f45608"]]},{"id":"761423cd.d3881c","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"#:(store)::autoMode","pt":"flow","to":"mode","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3400,"y":1720,"wires":[["6efe762.a068f88"]]},{"id":"59d10a57.ef1e54","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":880,"wires":[["f660b0f5.02674"]]},{"id":"5c995479.83034c","type":"function","z":"79ddab3e.2ca0c4","name":"aktualisiere flow.options","func":"flow.get(\"options\", \"store\")[msg.field] = msg.payload;\n\nreturn {};","outputs":1,"noerr":0,"initialize":"// Der Code hier wird ausgeführt,\n// wenn der Node gestartet wird\nvar storeName = \"store\";\nflow.set(\"options\", flow.get(\"options\", storeName) || {}, storeName);","finalize":"","libs":[],"x":3210,"y":940,"wires":[["a86c098b.8ba4c8"]]},{"id":"f660b0f5.02674","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":880,"wires":[["c715ba47.4785c8"]]},{"id":"5bf5ee73.f906","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":820,"wires":[["c715ba47.4785c8"]]},{"id":"1fafbd65.55bab3","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":700,"wires":[["c715ba47.4785c8"]]},{"id":"2037cd9a.b30ad2","type":"inject","z":"79ddab3e.2ca0c4","name":"rooms","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"0","topic":"","payload":"[\"global\", \"badezimmer\", \"duschbad\", \"nino\", \"noah\", \"arbeitszimmer\", \"kueche\", \"wohnzimmer\", \"schlafzimmer\"]","payloadType":"json","x":2430,"y":620,"wires":[["bc9cd8d5.1d0278"]]},{"id":"bc9cd8d5.1d0278","type":"change","z":"79ddab3e.2ca0c4","name":"flow.rooms","rules":[{"t":"set","p":"#:(store)::rooms","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":620,"wires":[[]]},{"id":"728c1078.b44f8","type":"trigger","z":"79ddab3e.2ca0c4","name":"","op1":"","op2":"#:(store)::rooms","op1type":"nul","op2type":"flow","duration":"250","extend":true,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":3140,"y":400,"wires":[["2a63a172.fa0c5e"]]},{"id":"2a63a172.fa0c5e","type":"split","z":"79ddab3e.2ca0c4","name":"split rooms","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":3310,"y":400,"wires":[["22977410.1a619c"]]},{"id":"22977410.1a619c","type":"function","z":"79ddab3e.2ca0c4","name":"berechne Inputs neu","func":"var room = msg.payload;\nvar storeName = \"store\";\n\nvar options = flow.get(\"options\", storeName);\nvar specific = options[\"specific\"][\"global\"] ? false : options[\"specific\"][room];\nvar lookup = (field => options[field][specific ? room : \"global\"]);\nvar auto = lookup(\"auto\");\n\nreturn [[\n    {\"room\": room, \"field\": \"specific\", \"payload\": specific},\n    {\"room\": room, \"field\": \"auto\", \"payload\": auto},\n    {\"room\": room, \"field\": \"mode\", \"payload\": auto ? flow.get(\"autoMode\", storeName) : lookup(\"mode\")},\n    {\"room\": room, \"field\": \"position\", \"payload\": lookup(\"position\")},\n    {\"room\": room, \"field\": \"active\", \"payload\": lookup(\"active\")},\n    {\"room\": room, \"field\": \"from_earliest_workday\", \"payload\": lookup(\"fromEarliestWorkday\")},\n    {\"room\": room, \"field\": \"until_latest_workday\", \"payload\": lookup(\"untilLatestWorkday\")},\n    {\"room\": room, \"field\": \"from_earliest_holiday\", \"payload\": lookup(\"fromEarliestHoliday\")},\n    {\"room\": room, \"field\": \"until_latest_holiday\", \"payload\": lookup(\"untilLatestHoliday\")}\n]];\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3500,"y":400,"wires":[["34f03d.96498fc4"]]},{"id":"cb001993.b57198","type":"function","z":"79ddab3e.2ca0c4","name":"generiere Service Call","func":"var domain = type => `input_${type}`;\n\nfunction entity (type, field, room) {\n    return domain(type) + `.blind_control_${field}_${room}`\n}\n\nfunction service (type, value) {\n    return {\n        \"boolean\": value ? \"turn_on\" : \"turn_off\",\n        \"select\": \"select_option\",\n        \"number\": \"set_value\",\n        \"datetime\": \"set_datetime\"\n    }[type]\n}\n\nfunction data (type, value) {\n    switch (type) {\n        case \"select\":\n            return {\"option\": value};\n        case \"number\":\n            return {\"value\": value};\n        case \"datetime\":\n            return {\"time\": value};\n    }\n}\n\nfunction message (room, field, value) {\n    var type = {\n        \"specific\": \"boolean\",\n        \"auto\": \"boolean\",\n        \"mode\": \"select\",\n        \"active\": \"boolean\",\n        \"position\": \"number\",\n        \"from_earliest_workday\": \"datetime\",\n        \"until_latest_workday\": \"datetime\",\n        \"from_earliest_holiday\": \"datetime\",\n        \"until_latest_holiday\": \"datetime\"\n    }[field];\n    return {\n        \"domain\": domain(type),\n        \"service\": service(type, value),\n        \"entity_id\": entity(type, field, room),\n        \"data\": data(type, value)\n    }\n}\n\nreturn message(msg.room, msg.field, msg.payload);\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3780,"y":560,"wires":[["1db35bfa.d0aa34"]]},{"id":"a86c098b.8ba4c8","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["ff6e5cc9.4478f"],"x":3355,"y":940,"wires":[]},{"id":"ff6e5cc9.4478f","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["a86c098b.8ba4c8","6efe762.a068f88","cd1137f4.399fe8"],"x":3015,"y":400,"wires":[["728c1078.b44f8"]]},{"id":"146418ff.2a3997","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Override: Position","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"^input_number.blind_control_position_[a-z]+$","entityidfiltertype":"regex","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"field","propertyType":"msg","value":"position","valueType":"str"}],"x":2390,"y":760,"wires":[["41f6a980.39d0e8"]]},{"id":"41f6a980.39d0e8","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":760,"wires":[["9e95ec9.261b21"]]},{"id":"a3154844.b958b8","type":"link in","z":"79ddab3e.2ca0c4","name":"Kontextänderung","links":["79875059.6dd7","6ac1134a.417f2c"],"x":3155,"y":220,"wires":[["3b2457f4.7bf708"]]},{"id":"cd3ac6f9.3d2558","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":1160,"wires":[["12c64dcb.aac152"]]},{"id":"12c64dcb.aac152","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(kueche|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":1160,"wires":[["f08ac1a8.b9091","ed068856.607ad8"]]},{"id":"c1ca23b4.9fab3","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(wohnzimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":1420,"wires":[["8a0c6daa.f80d2","7a8ae7b.f6d2418","f48275fc.3b24f8"]]},{"id":"b1b8e0d6.83f92","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":1420,"wires":[["c1ca23b4.9fab3"]]},{"id":"fa839915.e84128","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(schlafzimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":1800,"wires":[["c991f710.fbeda8"]]},{"id":"42c34c14.ad5d94","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":1800,"wires":[["fa839915.e84128"]]},{"id":"361f5f1d.898cf","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(badezimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":180,"wires":[["83f37a28.e1a038"]]},{"id":"845c5fe1.7c90b","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":180,"wires":[["361f5f1d.898cf"]]},{"id":"41868de8.4a21a4","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(duschbad|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":340,"wires":[["b84086f8.fd1638"]]},{"id":"5b81bd3d.5a99c4","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":340,"wires":[["41868de8.4a21a4"]]},{"id":"84f6025.886c7","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(nino|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":500,"wires":[["530d0076.f4c11","930b0dd4.d787"]]},{"id":"902b3788.3b5bb8","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":500,"wires":[["84f6025.886c7"]]},{"id":"d9184e83.1f921","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(noah|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":760,"wires":[["52fdd7e6.9f26f8","6c4f0fcd.c6b12"]]},{"id":"99c6882.54cde78","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":760,"wires":[["d9184e83.1f921"]]},{"id":"bad33b7.474eac8","type":"switch","z":"79ddab3e.2ca0c4","name":"room?","property":"room","propertyType":"msg","rules":[{"t":"regex","v":"^(arbeitszimmer|global)$","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":1,"x":410,"y":1020,"wires":[["b8bd6d70.5c8d3"]]},{"id":"e9b0bfd7.1a1b3","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["76e1cfbd.5e675"],"x":315,"y":1020,"wires":[["bad33b7.474eac8"]]},{"id":"9e95ec9.261b21","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":760,"wires":[["c715ba47.4785c8"]]},{"id":"34f03d.96498fc4","type":"switch","z":"79ddab3e.2ca0c4","name":"Steuernachricht?","property":"field","propertyType":"msg","rules":[{"t":"eq","v":"position","vt":"str"},{"t":"eq","v":"mode","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":3330,"y":540,"wires":[["a0d99161.bcc13"],["91813548.074448"],["cb001993.b57198"]]},{"id":"79875059.6dd7","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["df9da4f4.93f5c8","726300f6.eb244","cf2d806a.d6fad","75758e65.16128","3aad7d02.afaef2","2aacee48.8e2122","9d95ce88.fa71c","ff22d323.85a78","a3154844.b958b8"],"x":3895,"y":500,"wires":[]},{"id":"a0d99161.bcc13","type":"function","z":"79ddab3e.2ca0c4","name":"position","func":"var header = {\n    \"room\": msg.room,\n    \"reason\": \"manual\"\n};\n\npositionMessages = []\nswitch (msg.payload) {\n    case -20:\n        msg.payload = -10;\n        positionMessages.push({\n            ...header,\n            \"reset\": true\n        });\n        break\n    case -10:\n        break;\n    default:\n        positionMessages.push({\n            ...header,\n            \"position\": msg.payload / 100\n        });\n}\n\nreturn [positionMessages, msg];\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3560,"y":480,"wires":[["180efc32.3c6dd4"],["cb001993.b57198"]]},{"id":"180efc32.3c6dd4","type":"switch","z":"79ddab3e.2ca0c4","name":"room != global?","property":"room","propertyType":"msg","rules":[{"t":"neq","v":"global","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":3780,"y":500,"wires":[["79875059.6dd7"]]},{"id":"f0e61790.f3e668","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":[],"x":-35,"y":140,"wires":[[]]},{"id":"2957dfef.1b5b6","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":[],"x":-35,"y":280,"wires":[[]]},{"id":"682cbbf.605b544","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["6519afc9.b92dd"],"x":75,"y":160,"wires":[["76e1cfbd.5e675"]]},{"id":"6519afc9.b92dd","type":"link out","z":"79ddab3e.2ca0c4","name":"Steuerung","links":["682cbbf.605b544"],"x":3395,"y":140,"wires":[]},{"id":"91813548.074448","type":"function","z":"79ddab3e.2ca0c4","name":"mode","func":"var modes = {\n    \"aus\": 0,\n    \"Winter\": 1,\n    \"Sonnenlicht minimieren\": 3,\n    \"Sommer\": 16\n};\n\nreturn [\n    {\"room\": msg.room, \"mode\": modes[msg.payload]},\n    msg\n];\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3550,"y":520,"wires":[["180efc32.3c6dd4"],["cb001993.b57198"]]},{"id":"84c36164.fcef2","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Regen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.weather_raining","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"condition","propertyType":"msg","value":"raining","valueType":"str"}],"x":2430,"y":140,"wires":[["d790669c11582d9d"]]},{"id":"6efe762.a068f88","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["ff6e5cc9.4478f"],"x":3535,"y":1720,"wires":[]},{"id":"143cec6e.e94174","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":1060,"wires":[["a3bcd580.725a88"]]},{"id":"1cb82a3b.a3a476","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":1180,"wires":[["c715ba47.4785c8"]]},{"id":"5e4ed2ae.35d29c","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":1180,"wires":[["1cb82a3b.a3a476"]]},{"id":"9553c3af.b4e0e","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":1120,"wires":[["f6e42c7b.fbcd7"]]},{"id":"f6e42c7b.fbcd7","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":1120,"wires":[["c715ba47.4785c8"]]},{"id":"a3bcd580.725a88","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":1060,"wires":[["c715ba47.4785c8"]]},{"id":"eeb04577.e27bc8","type":"change","z":"79ddab3e.2ca0c4","name":"msg.room","rules":[{"t":"set","p":"room","pt":"msg","to":"$split(msg.topic, \"_\")[-1]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":1000,"wires":[["a44db1d2.ddc18"]]},{"id":"a44db1d2.ddc18","type":"join","z":"79ddab3e.2ca0c4","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"room","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"1","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2780,"y":1000,"wires":[["c715ba47.4785c8"]]},{"id":"8a0c6daa.f80d2","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Terrasse – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"marqueeOpen","operator":"equal","operatorText":"=","thresholdType":"bool","threshold":"true"},{"condition":2,"conditionText":"und","valueType":"pdsCalcAzimuth","value":"","operator":"lt","operatorText":"<","thresholdType":"numAzimuth","threshold":"220"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.marqueeOpen</var> = true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>\"Sonnenrichtung\"</var> < \"Sonnenrichtung\"</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestWorkday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestHoliday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestWorkday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestHoliday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1.98","windowBottomType":"num","windowBottom":"0.27","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"131","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"279","oversteers":[],"oversteerTopic":"","x":630,"y":1600,"wires":[["39dea74a.5370c8"],[]]},{"id":"7a8ae7b.f6d2418","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Terrasse – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"marqueeOpen","operator":"equal","operatorText":"=","thresholdType":"bool","threshold":"true"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.marqueeOpen</var> = true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>"},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestWorkday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestHoliday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestWorkday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestHoliday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1.98","windowBottomType":"num","windowBottom":"0.27","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"131","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"279","oversteers":[],"oversteerTopic":"","x":620,"y":1660,"wires":[["e3e74aca.2ae0c8"],[]]},{"id":"c991f710.fbeda8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Schlafzimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....arliestWorkday.schlafzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....arliestHoliday.schlafzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....lLatestWorkday.schlafzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.schlafzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....lLatestHoliday.schlafzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.51","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"128","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"282","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"S","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":620,"y":1860,"wires":[["7d8da7cc.3697e8"],[]]},{"id":"8b6f1e7a.974c6","type":"comment","z":"79ddab3e.2ca0c4","name":"Rolläden","info":"","x":200,"y":80,"wires":[]},{"id":"76b5c7b0.3f5978","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Sturm","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.weather_storm","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"seconds","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"condition","propertyType":"msg","value":"storm","valueType":"str"},{"property":"delay","propertyType":"msg","value":"300000","valueType":"num"}],"x":2430,"y":200,"wires":[["7f08c86c.4cf0b8"]]},{"id":"7f08c86c.4cf0b8","type":"change","z":"79ddab3e.2ca0c4","name":"alert & reset","rules":[{"t":"set","p":"#:(store)::alert","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"reset","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2610,"y":200,"wires":[["1d04ceb5.641b11"]]},{"id":"f48275fc.3b24f8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Wohnzimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestWorkday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestHoliday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestWorkday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.wohnzimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestHoliday.wohnzimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"1.96","windowBottomType":"num","windowBottom":"0.51","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"220","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"10","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"equal","operatorText":"=","thresholdType":"str","threshold":"W","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":1480,"wires":[["4d971092.e14ef"],[]]},{"id":"ed068856.607ad8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Küche – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow.....fromEarliestWorkday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow.....fromEarliestHoliday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....s.untilLatestWorkday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....s.untilLatestHoliday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"1.02","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"220","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"10","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"W","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":1280,"wires":[["9d69a582.3d4b98"],[]]},{"id":"f08ac1a8.b9091","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Küche – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow.....fromEarliestWorkday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow.....fromEarliestHoliday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....s.untilLatestWorkday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.kueche","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....s.untilLatestHoliday.kueche</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"1.02","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"N","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":620,"y":1220,"wires":[["adcc7c38.74e0a"],[]]},{"id":"b8bd6d70.5c8d3","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Arbeitszimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....rliestWorkday.arbeitszimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....rliestHoliday.arbeitszimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....LatestWorkday.arbeitszimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.arbeitszimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....LatestHoliday.arbeitszimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.51","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"N","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":620,"y":1080,"wires":[["3e1b19ef.ad6db6"],[]]},{"id":"6c4f0fcd.c6b12","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Noah – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestWorkday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestHoliday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestWorkday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestHoliday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"N","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":880,"wires":[["e0506eb0.24dc7"],[]]},{"id":"52fdd7e6.9f26f8","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Noah – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestWorkday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestHoliday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestWorkday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.noah","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestHoliday.noah</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"num","threshold":"N","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":620,"y":820,"wires":[["276e7b69.24efd4"],[]]},{"id":"530d0076.f4c11","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Nino – links","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestWorkday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestHoliday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestWorkday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestHoliday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"310","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"100","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"N","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":620,"wires":[["17fd404f.efe5d"],[]]},{"id":"930b0dd4.d787","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Nino – rechts","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestWorkday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....ns.fromEarliestHoliday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestWorkday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.nino","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>bürgerliche Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....ons.untilLatestHoliday.nino</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"40","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"190","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"E","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":560,"wires":[["b52cb0a1.382cb"],[]]},{"id":"b84086f8.fd1638","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Duschbad","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.duschbad","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....romEarliestWorkday.duschbad</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.duschbad","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....romEarliestHoliday.duschbad</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.duschbad","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....untilLatestWorkday.duschbad</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.duschbad","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....untilLatestHoliday.duschbad</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"40","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"190","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"str","threshold":"E","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":400,"wires":[["f82044.38329fc"],[]]},{"id":"83f37a28.e1a038","type":"blind-control","z":"79ddab3e.2ca0c4","name":"Badezimmer","topic":"","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":false,"autoTriggerTime":"1200000","startDelayTime":"10000","contextStore":"store","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"level"},{"p":"slat","pt":"msg","v":"","vt":"slat"},{"p":"blindCtrl","pt":"msg","v":"","vt":"ctrlObj"}],"blindIncrement":"0.05","blindOpenPos":"1","blindClosedPos":0,"blindPosDefault":"open (max)","blindPosDefaultType":"levelFixed","slatPosDefault":"","slatPosDefaultType":"none","overwriteExpire":"","rules":[{"index":0,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>msg.windowOpen</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div></div>"},{"index":1,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunriseStart","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>Sonnenaufgang Beginn</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":2,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestWorkday.badezimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestWorkday.badezimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":3,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.today.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"civilDawn","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"flow","value":"#:(store)::options.fromEarliestHoliday.badezimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.today.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>bürgerliche Morgendämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>flow....mEarliestHoliday.badezimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":4,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"false","operatorText":"ist false","thresholdType":"num","threshold":"0"},{"condition":2,"conditionText":"und","valueType":"flow","value":"#:(store)::conditions.raining","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"50%","operator":2,"operatorText":"⭱️❗  Maximum (übersteuernd)"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist false&nbsp;<strong>und</strong><br/><span class=\"indent-enh-text\" >&nbsp;</span><var>flow.conditions.raining</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-up\" aria-hidden=\"true\"></i><span>⭱️ maximale Rollladen Position: </span><var>50%</var></div></div>","importance":0,"slat":{"type":"none","value":""}},{"index":5,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::conditions.storm","operator":"true","operatorText":"ist true","thresholdType":"num","threshold":"0"}],"level":{"type":"levelFixed","value":"open (max)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":true,"importance":0,"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.conditions.storm</var> ist true</div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>offen (max)</var></div><div class=\"indent-resetOverwrite-text\"> <i class=\"fa fa-thumbs-o-down\" aria-hidden=\"true\"></i><span>manuelle Überschreibung verfällt wenn die Regel aktiv wird</span> </div></div>"},{"index":6,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestWorkday.badezimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestWorkday.badezimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":7,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"flow","value":"#:(store)::dayInfo.tomorrow.isWorkday","operator":"false","operatorText":"ist false","thresholdType":"str","threshold":""}],"level":{"type":"levelFixed","value":"closed (min)","operator":0,"operatorText":"↕  Absolut"},"slat":{"type":"none","value":""},"topic":"","resetOverwrite":false,"importance":0,"time":{"type":"pdsTime","value":"nauticalDusk","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMax":{"type":"flow","value":"#:(store)::options.untilLatestHoliday.badezimmer","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>flow.dayInfo.tomorrow.isWorkday</var> ist false</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>nautische Abenddämmerung</var><div class=\"indent-time-text\"><i class=\"fa fa-step-forward\" aria-hidden=\"true\"></i> <span>spätestens (max)</span> <var>flow....tilLatestHoliday.badezimmer</var></div></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i><span>Rollladenposition: </span> ↕  Absolut <var>geschlossen (min)</var></div></div>"},{"index":8,"name":"","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"msg","value":"windowOpen","operator":"true","operatorText":"ist true","thresholdType":"str","threshold":"windowOpen"}],"level":{"type":"num","value":"0.15","operator":1,"operatorText":"⭳❗  Minimum (übersteuernd)"},"time":{"type":"pdsTime","value":"sunsetEnd","operator":1,"operatorText":"↧ von","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>msg.windowOpen</var> ist true</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↧ von <var>Sonnenuntergang Ende</var></div><div><div class=\"indent-level-text\"> <i class=\"fa fa-chevron-circle-down\" aria-hidden=\"true\"></i><span>⭳ minimale Rollladen Position: </span><var>0.15</var></div></div>","importance":0,"slat":{"type":"none","value":""}}],"sunControlMode":16,"sunFloorLengthType":"num","sunFloorLength":"0.3","sunMinDelta":"","blindPosMin":"25%","blindPosMinType":"levelFixed","blindPosMax":"open (max)","blindPosMaxType":"levelFixed","blindOpenPosOffset":"","blindClosedPosOffset":"","sunSlat":"","sunSlatType":"none","smoothTime":"","sunTopic":"","windowTopType":"num","windowTop":"2.01","windowBottomType":"num","windowBottom":"0.97","windowAzimuthStartType":"numAzimuth","windowAzimuthStart":"40","windowAzimuthEndType":"numAzimuth","windowAzimuthEnd":"190","oversteers":[{"mode":16,"valueType":"flow","value":"#:(store)::shadow","operator":"contain","operatorText":"enthält","thresholdType":"num","threshold":"E","onlySunInWindow":true,"blindPos":{"type":"levelFixed","value":"open (max)"},"slatPos":{"type":"none","value":""}}],"oversteerTopic":"","x":610,"y":240,"wires":[["8719beb2.469b"],[]]},{"id":"1d04ceb5.641b11","type":"function","z":"79ddab3e.2ca0c4","name":"aktualisiere flow.conditions","func":"flow.get(\"conditions\", \"store\")[msg.condition] = msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"var storeName = \"store\";\nflow.set(\"conditions\", flow.get(\"conditions\", storeName) || {}, storeName);","finalize":"","libs":[],"x":2860,"y":140,"wires":[["a7fe70e9.87fac"]]},{"id":"40761c1b.eef7f4","type":"inject","z":"79ddab3e.2ca0c4","name":"jede Minute","props":[],"repeat":"","crontab":"*/1 0-23 * * *","once":false,"onceDelay":0.1,"topic":"","x":2910,"y":80,"wires":[["a7fe70e9.87fac"]]},{"id":"26ceed34.40d052","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"aktuelle Temperatur","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.weather_forecast_temperature_interpolated","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"topic","propertyType":"msg","value":"temperature","valueType":"str"},{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"x":2390,"y":1560,"wires":[["fd04dc1.3be172"]]},{"id":"2f712298.10c6be","type":"switch","z":"79ddab3e.2ca0c4","name":"temperatureMax < 22.5 °C?","property":"payload.temperatureMax","propertyType":"msg","rules":[{"t":"lt","v":"22.5","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2660,"y":1700,"wires":[["f44628aa.f71908"],["385c87d5.6c0e88"]]},{"id":"cff80483.f75ae8","type":"api-call-service","z":"79ddab3e.2ca0c4","name":"setze Position","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"cover","service":"set_cover_position","areaId":[],"deviceId":[],"entityId":["{{entity_id}}"],"data":"{\"position\": 100 * msg.payload}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1560,"y":240,"wires":[[]]},{"id":"80693c86.251eb","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_arbeitszimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1080,"wires":[["c442a344ee1ad8eb"]]},{"id":"22015346.7f02bc","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_kueche_rechts","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1220,"wires":[["c442a344ee1ad8eb"]]},{"id":"5ee9b008.5f4d7","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_kueche_links","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1280,"wires":[["c442a344ee1ad8eb"]]},{"id":"647d9e4d.7cdbb","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_terrasse_links","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1660,"wires":[["c442a344ee1ad8eb"]]},{"id":"c1bef3e9.5100d","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_wohnzimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1480,"wires":[["c442a344ee1ad8eb"]]},{"id":"5154f42.a7cb10c","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_terrasse_rechts","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1600,"wires":[["c442a344ee1ad8eb"]]},{"id":"278c67c7.27e608","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_schlafzimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":1860,"wires":[["c442a344ee1ad8eb"]]},{"id":"6bc48c93.4fa614","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_noah_links","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":880,"wires":[["c442a344ee1ad8eb"]]},{"id":"491d4a0b.61f174","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_noah_rechts","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":820,"wires":[["c442a344ee1ad8eb"]]},{"id":"bec27538.788338","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_nino_links","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":620,"wires":[["c442a344ee1ad8eb"]]},{"id":"53ef1349.0cc05c","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_nino_rechts","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":560,"wires":[["c442a344ee1ad8eb"]]},{"id":"56013b77.0255c4","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_duschbad","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":400,"wires":[["c442a344ee1ad8eb"]]},{"id":"562f46a8.2ca9a8","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"entity_id","pt":"msg","to":"cover.roller_shutter_badezimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":240,"wires":[["c442a344ee1ad8eb"]]},{"id":"3ac3fb86.fd6404","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_schlafzimmer_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1860,"wires":[["c991f710.fbeda8"]]},{"id":"cb118418.8c98c8","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_nino_links_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":620,"wires":[["530d0076.f4c11"]]},{"id":"43988701f8ced0ce","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_noah_rechts_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":820,"wires":[["52fdd7e6.9f26f8"]]},{"id":"6780d3c1ad9d280a","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Fenster offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.window_sensor_nino_rechts_window_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"windowOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":560,"wires":[["930b0dd4.d787"]]},{"id":"7f9b8a323f3153a5","type":"server-state-changed","z":"79ddab3e.2ca0c4","name":"Markise offen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.marquee_is_open","entityidfiltertype":"exact","outputinitially":true,"state_type":"habool","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"marqueeOpen","propertyType":"msg","value":"","valueType":"entityState"}],"x":330,"y":1600,"wires":[["8a0c6daa.f80d2","7a8ae7b.f6d2418"]]},{"id":"e63204c4232f5c0f","type":"switch","z":"79ddab3e.2ca0c4","name":"temperature < 0 °C?","property":"payload.temperature","propertyType":"msg","rules":[{"t":"lt","v":"0","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2920,"y":1640,"wires":[["7936bb15.899f44"],["2f712298.10c6be"]]},{"id":"e3a7303ba129b85d","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Badezimmer","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_badezimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":180,"wires":[[]]},{"id":"a97f891155a24fe3","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Duschbad","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_duschbad"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":340,"wires":[[]]},{"id":"ae24157bbcb644ae","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Nino rechts","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_nino_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":500,"wires":[[]]},{"id":"d3d128cf86485fe9","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Nino links","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_nino_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1240,"y":680,"wires":[[]]},{"id":"eaa4cef39e9e250d","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Noah rechts","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_noah_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":760,"wires":[[]]},{"id":"3e60f5e82daa1b07","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Noah links","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_noah_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":940,"wires":[[]]},{"id":"48110af5440c3632","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Arbeitszimmer","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_arbeitszimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1260,"y":1020,"wires":[[]]},{"id":"a52a9b6776be398b","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Küche rechts","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_kueche_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":1160,"wires":[[]]},{"id":"f30c64467d309263","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Küche links","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_kueche_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":1340,"wires":[[]]},{"id":"46e7518f5cf3a73c","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Wohnzimmer","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_wohnzimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1250,"y":1420,"wires":[[]]},{"id":"4ca41dc63c2fde47","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Terrasse rechts","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_terrasse_rechts"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1260,"y":1540,"wires":[[]]},{"id":"16575c7735cc6c0d","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Terrasse links","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_terrasse_links"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1260,"y":1720,"wires":[[]]},{"id":"b334a48464a76b79","type":"ha-entity","z":"79ddab3e.2ca0c4","name":"Schlafzimmer","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"blind_control_schlafzimmer"},{"property":"device_class","value":""},{"property":"icon","value":""},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"100 * msg.payload","stateType":"jsonata","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1260,"y":1800,"wires":[[]]},{"id":"98b0498fb47c8f9f","type":"delay","z":"79ddab3e.2ca0c4","name":"zufällige Verzögerung (0-150 ms)","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"5","nbRateUnits":"1","rateUnits":"second","randomFirst":"0","randomLast":"150","randomUnits":"milliseconds","drop":false,"allowrate":false,"outputs":1,"x":1620,"y":180,"wires":[["cff80483.f75ae8"]]},{"id":"538a9afc978aa44f","type":"link in","z":"79ddab3e.2ca0c4","name":"","links":["c442a344ee1ad8eb"],"x":1435,"y":60,"wires":[["454f3db361c3ace8"]]},{"id":"c442a344ee1ad8eb","type":"link out","z":"79ddab3e.2ca0c4","name":"","links":["538a9afc978aa44f"],"x":1515,"y":1200,"wires":[]},{"id":"454f3db361c3ace8","type":"change","z":"79ddab3e.2ca0c4","name":"lösche msg.reset","rules":[{"t":"delete","p":"reset","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1570,"y":60,"wires":[["b6af474703137601"]]},{"id":"b6af474703137601","type":"switch","z":"79ddab3e.2ca0c4","name":"Rolladensteuerung an?","property":"homeassistant.homeAssistant.states['input_boolean.blind_control_on_global'].state","propertyType":"global","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":1590,"y":120,"wires":[["98b0498fb47c8f9f"]]},{"id":"d790669c11582d9d","type":"change","z":"79ddab3e.2ca0c4","name":"false","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":2590,"y":140,"wires":[["1d04ceb5.641b11"]]},{"id":"3b2457f4.7bf708","type":"no-op","z":"79ddab3e.2ca0c4","name":"","x":3290,"y":140,"wires":[["b7461eaa.f9dbc","6519afc9.b92dd"]]},{"id":"5ecf03a2347fd854","type":"clock-timer","z":"79ddab3e.2ca0c4","name":"Schatten","topic":"shadow","addIdType":"none","addId":"","positionConfig":"a962ddc.fbff22","autoTrigger":true,"autoTriggerTime":1200000,"startDelayTime":"1000","contextStore":"default","results":[{"p":"","pt":"msgTopic","v":"","vt":"topic"},{"p":"","pt":"msgPayload","v":"","vt":"payload"}],"overwriteExpire":"","rules":[{"index":0,"name":"E","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"pdsCalcElevation","value":"","operator":"lte","operatorText":"<=","thresholdType":"numAltitude","threshold":"14.8"}],"payload":{"type":"str","value":"E","offsetType":"none","offset":"1","multiplier":60000,"format":""},"topic":"shadow","importance":0,"resetOverwrite":false,"time":{"type":"pdsTimeByAzimuth","value":"120","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"pdsTimeByAzimuth","value":"98.6","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>\"Sonnenhöhenwinkel\"</var> <= \"Sonnenhöhenwinkel\"</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>\"Zeit durch Sonnenrichtung\"</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>\"Zeit durch Sonnenrichtung\"</var></div></div><div><div class=\"indent-payload-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>Payload:</span> <var>\"E\"</var></div><div class=\"indent-topic-text\"> <i class=\"fa fa-tasks\" aria-hidden=\"true\"></i><span>Topic: </span> <var>shadow</var></div></div>"},{"index":1,"name":"S","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"pdsCalcElevation","value":"","operator":"lte","operatorText":"<=","thresholdType":"numAltitude","threshold":"35"}],"payload":{"type":"str","value":"S","offsetType":"none","offset":"1","multiplier":60000,"format":""},"topic":"shadow","importance":0,"resetOverwrite":false,"time":{"type":"pdsTimeByAzimuth","value":"210","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"pdsTimeByAzimuth","value":"180","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>\"Sonnenhöhenwinkel\"</var> <= \"Sonnenhöhenwinkel\"</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>\"Zeit durch Sonnenrichtung\"</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>\"Zeit durch Sonnenrichtung\"</var></div></div><div><div class=\"indent-payload-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>Payload:</span> <var>\"S\"</var></div><div class=\"indent-topic-text\"> <i class=\"fa fa-tasks\" aria-hidden=\"true\"></i><span>Topic: </span> <var>shadow</var></div></div>"},{"index":2,"name":"SW","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"pdsCalcElevation","value":"","operator":"lte","operatorText":"<=","thresholdType":"numAltitude","threshold":"10.9"}],"payload":{"type":"str","value":"SW","offsetType":"none","offset":"1","multiplier":60000,"format":""},"topic":"shadow","importance":0,"resetOverwrite":false,"time":{"type":"pdsTimeByAzimuth","value":"260","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"pdsTimeByAzimuth","value":"250","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>\"Sonnenhöhenwinkel\"</var> <= \"Sonnenhöhenwinkel\"</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>\"Zeit durch Sonnenrichtung\"</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>\"Zeit durch Sonnenrichtung\"</var></div></div><div><div class=\"indent-payload-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>Payload:</span> <var>\"SW\"</var></div><div class=\"indent-topic-text\"> <i class=\"fa fa-tasks\" aria-hidden=\"true\"></i><span>Topic: </span> <var>shadow</var></div></div>"},{"index":3,"name":"W","version":3,"enabled":true,"isValid":true,"conditions":[{"valueType":"pdsCalcElevation","value":"","operator":"lte","operatorText":"<=","thresholdType":"numAltitude","threshold":"17"}],"payload":{"type":"str","value":"W","offsetType":"none","offset":"1","multiplier":60000,"format":""},"topic":"shadow","importance":0,"resetOverwrite":false,"time":{"type":"pdsTimeByAzimuth","value":"280","operator":0,"operatorText":"↥ bis","offsetType":"none","offset":"1","multiplier":60000,"days":"*","months":"*"},"timeMin":{"type":"pdsTimeByAzimuth","value":"263","offsetType":"none","offset":"1","multiplier":60000},"description":"<div><i class=\"fa fa-code-fork\" aria-hidden=\"true\"></i> <var>\"Sonnenhöhenwinkel\"</var> <= \"Sonnenhöhenwinkel\"</div><div><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> ↥ bis <var>\"Zeit durch Sonnenrichtung\"</var><div class=\"indent-time-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>frühestens (min)</span> <var>\"Zeit durch Sonnenrichtung\"</var></div></div><div><div class=\"indent-payload-text\"><i class=\"fa fa-step-backward\" aria-hidden=\"true\"></i> <span>Payload:</span> <var>\"W\"</var></div><div class=\"indent-topic-text\"> <i class=\"fa fa-tasks\" aria-hidden=\"true\"></i><span>Topic: </span> <var>shadow</var></div></div>"}],"payloadDefault":"","payloadDefaultType":"str","payloadDefaultTimeFormat":0,"payloadDefaultOffset":0,"payloadDefaultOffsetType":"none","payloadDefaultOffsetMultiplier":60000,"x":2420,"y":1280,"wires":[[],[]]},{"id":"0836c2c61aab4e22","type":"change","z":"79ddab3e.2ca0c4","name":"","rules":[{"t":"set","p":"#:(store)::shadow","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2630,"y":1280,"wires":[[]]},{"id":"83bac197176d7dbc","type":"api-call-service","z":"e6cb2a0bf9f73b5e","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"cover","service":"open_cover","areaId":[],"deviceId":[],"entityId":["{{cover}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":480,"wires":[[]]},{"id":"09484e15972ba66a","type":"api-call-service","z":"e6cb2a0bf9f73b5e","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"cover","service":"close_cover","areaId":[],"deviceId":[],"entityId":["{{cover}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":560,"wires":[[]]},{"id":"383bbdd3d9984f6d","type":"server-state-changed","z":"e6cb2a0bf9f73b5e","name":"Außentemperatur","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.weather_forecast_temperature_interpolated","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"outside","valueType":"str"}],"x":220,"y":60,"wires":[["e680d1b46a5b378d","7c3efb0d1a098d8d"]]},{"id":"333103c29cfaa84e","type":"server-state-changed","z":"e6cb2a0bf9f73b5e","name":"Innentemperatur Ankleide","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.thermostat_ankleide_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"inside","valueType":"str"}],"x":190,"y":140,"wires":[["7c3efb0d1a098d8d"]]},{"id":"6c9531bc134aa759","type":"server-state-changed","z":"e6cb2a0bf9f73b5e","name":"Innentemperatur Flur","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.thermostat_flur_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"inside","valueType":"str"}],"x":200,"y":220,"wires":[["e680d1b46a5b378d"]]},{"id":"7c3efb0d1a098d8d","type":"join","z":"e6cb2a0bf9f73b5e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":450,"y":140,"wires":[["852a762ee830a0ca"]]},{"id":"e680d1b46a5b378d","type":"join","z":"e6cb2a0bf9f73b5e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":450,"y":220,"wires":[["679d3085d4778717"]]},{"id":"852a762ee830a0ca","type":"change","z":"e6cb2a0bf9f73b5e","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ankleide","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":140,"wires":[["04894eeb0b5e4de6"]]},{"id":"679d3085d4778717","type":"change","z":"e6cb2a0bf9f73b5e","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"flur","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":220,"wires":[["04894eeb0b5e4de6"]]},{"id":"04894eeb0b5e4de6","type":"switch","z":"e6cb2a0bf9f73b5e","name":"vollständig?","property":"$count($keys(msg.payload))=2","propertyType":"jsonata","rules":[{"t":"true"}],"checkall":"false","repair":false,"outputs":1,"x":810,"y":180,"wires":[["e58ed7390174dda4"]]},{"id":"97e412c5a4894bb7","type":"switch","z":"e6cb2a0bf9f73b5e","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"ankleide","vt":"str"},{"t":"eq","v":"flur","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":370,"y":360,"wires":[["5f4df0d1e10b6ccc"],["84e06f400de108d0"]]},{"id":"085487eba947d528","type":"link in","z":"e6cb2a0bf9f73b5e","name":"","links":["e58ed7390174dda4"],"x":105,"y":360,"wires":[["f6a866ab5b61fb85"]]},{"id":"e58ed7390174dda4","type":"link out","z":"e6cb2a0bf9f73b5e","name":"","mode":"link","links":["085487eba947d528"],"x":915,"y":180,"wires":[]},{"id":"e87b40933beab24c","type":"trigger","z":"e6cb2a0bf9f73b5e","name":"","op1":"","op2":"0","op1type":"pay","op2type":"str","duration":"-15","extend":false,"overrideDelay":false,"units":"min","reset":"","bytopic":"topic","topic":"topic","outputs":1,"x":750,"y":360,"wires":[["0cba2370995a2446"]]},{"id":"521f632d0195838e","type":"link in","z":"e6cb2a0bf9f73b5e","name":"","links":["062403545e1943bf"],"x":105,"y":520,"wires":[["5dc498fef182bf33"]]},{"id":"062403545e1943bf","type":"link out","z":"e6cb2a0bf9f73b5e","name":"","mode":"link","links":["521f632d0195838e"],"x":1155,"y":360,"wires":[]},{"id":"5dc498fef182bf33","type":"change","z":"e6cb2a0bf9f73b5e","name":"setze Entities","rules":[{"t":"set","p":"cover","pt":"msg","to":"$lookup(\t   {\t       \"ankleide\": \"cover.lichtkuppel_ankleide\",\t       \"flur\": \"cover.lichtkuppel_flur\"\t   },\t   msg.topic\t)","tot":"jsonata"},{"t":"set","p":"autocool","pt":"msg","to":"$lookup(\t   {\t       \"ankleide\": \"input_boolean.auto_cooling_ankleide\",\t       \"flur\": \"input_boolean.auto_cooling_flur\"\t   },\t   msg.topic\t)","tot":"jsonata"},{"t":"delete","p":"hystdirection","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":520,"wires":[["f6881b8fbd88629c"]]},{"id":"f6a866ab5b61fb85","type":"change","z":"e6cb2a0bf9f73b5e","name":"outside – inside","rules":[{"t":"set","p":"payload","pt":"msg","to":"$round(msg.payload.outside-msg.payload.inside, 1)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":360,"wires":[["97e412c5a4894bb7"]]},{"id":"0cba2370995a2446","type":"delay","z":"e6cb2a0bf9f73b5e","name":"","pauseType":"timed","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":1000,"y":360,"wires":[["062403545e1943bf"]]},{"id":"5f4df0d1e10b6ccc","type":"hysteresis","z":"e6cb2a0bf9f73b5e","name":"","rising_threshold":"0","falling_threshold":"-0.2","initial_edge":"any","x":520,"y":320,"wires":[["e87b40933beab24c"]]},{"id":"84e06f400de108d0","type":"hysteresis","z":"e6cb2a0bf9f73b5e","name":"","rising_threshold":"0.5","falling_threshold":"0","initial_edge":"any","x":520,"y":400,"wires":[["e87b40933beab24c"]]},{"id":"649f280f266a5659","type":"api-current-state","z":"e6cb2a0bf9f73b5e","name":"open?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"open","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{cover}}","state_type":"str","blockInputOverrides":false,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":670,"y":560,"wires":[["09484e15972ba66a"],[]]},{"id":"ca885209faedb9e3","type":"api-current-state","z":"e6cb2a0bf9f73b5e","name":"closed?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"closed","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{cover}}","state_type":"str","blockInputOverrides":false,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":680,"y":480,"wires":[["83bac197176d7dbc"],[]]},{"id":"f6881b8fbd88629c","type":"api-current-state","z":"e6cb2a0bf9f73b5e","name":"autocool?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","entity_id":"{{autocool}}","state_type":"habool","blockInputOverrides":false,"outputProperties":[],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":360,"y":520,"wires":[["e803368737f381f3"],[]]},{"id":"e803368737f381f3","type":"switch","z":"e6cb2a0bf9f73b5e","name":"","property":"edge","propertyType":"msg","rules":[{"t":"eq","v":"falling","vt":"str"},{"t":"eq","v":"rising","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":510,"y":520,"wires":[["ca885209faedb9e3"],["649f280f266a5659"]]},{"id":"c1468a42eea018f0","type":"switch","z":"9bf7fb6e.7aac88","name":"Wandtaster Wohnzimmer?","property":"device_id","propertyType":"msg","rules":[{"t":"eq","v":"71a6e35835e3ac974599dcff07e671ff","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":360,"y":660,"wires":[["eaa3f2741baa2c7d"]]},{"id":"8fb984060706025c","type":"server-events","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":1,"event_type":"zwave_js_value_notification","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"node_id","propertyType":"msg","value":"$outputData(\"eventData\").event.node_id","valueType":"jsonata"},{"property":"device_id","propertyType":"msg","value":"$outputData(\"eventData\").event.device_id","valueType":"jsonata"},{"property":"key","propertyType":"msg","value":"$outputData(\"eventData\").event.property_key","valueType":"jsonata"},{"property":"value","propertyType":"msg","value":"$outputData(\"eventData\").event.value","valueType":"jsonata"}],"x":200,"y":740,"wires":[["72202d9b16981d7c"]]},{"id":"eaa3f2741baa2c7d","type":"function","z":"9bf7fb6e.7aac88","name":"generiere Tastendruck","func":"function status() {\n    var print = (s => (typeof s == \"string\") ? s : \"undefined\");\n    node.status({\"text\": `state: ${print(context.get(\"state\"))}, value: ${print(context.get(\"value\"))}, direction: ${print(context.get(\"direction\"))}, key: ${print(context.get(\"key\"))}`});\n}\n\nfunction setContext(key, value) {\n    context.set(key, value);\n    status();\n}\n\nfunction message (key) {\n    setContext(\"key\", key);\n    return {\"payload\": key};\n}\n\nif (msg.topic == \"state\") {\n    setContext(\"state\", msg.payload);\n    return;\n}\n\nvar state = context.get(\"state\");\nif (!state.match(\"^(on|off)$\")) {\n    return;\n}\n\nvar direction = context.get(\"direction\");\nvar value = msg.value;\nsetContext(\"value\", value);\nswitch (value) {\n    case \"KeyPressed\":\n        return message((state == \"on\") ? \"off-press\" : \"on-press\");\n    case \"KeyPressed2x\":\n        return message(\"on-press\");\n    case \"KeyHeldDown\":\n        return message(`${direction}-hold`);\n    case \"KeyReleased\":\n        setContext(\"direction\", direction == \"up\" ? \"down\" : \"up\");\n        return message(`${direction}-hold-release`);\n}\n","outputs":1,"noerr":0,"initialize":"function status() {\n    var print = (s => (typeof s == \"string\") ? s : \"undefined\");\n    node.status({\"text\": `state: ${print(context.get(\"state\"))}, value: ${print(context.get(\"value\"))}, direction: ${print(context.get(\"direction\"))}, key: ${print(context.get(\"key\"))}`});\n}\n\ncontext.set(\"state\", undefined);\ncontext.set(\"direction\", \"up\");\ncontext.set(\"value\", undefined);\ncontext.set(\"key\", undefined);\nstatus();","finalize":"","libs":[],"x":620,"y":660,"wires":[["e2c606c088b7a2f5"]]},{"id":"51eb7e5940b20171","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Licht Wohnzimmer","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.wohnzimmer","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"state","valueType":"str"}],"x":450,"y":600,"wires":[["eaa3f2741baa2c7d"]]},{"id":"b96304986ae5799d","type":"api-call-service","z":"9bf7fb6e.7aac88","name":"Schalter an","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"switch","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{switch}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":2130,"y":500,"wires":[["0ea45ed45f7f052d"]]},{"id":"903dfb0649325202","type":"change","z":"9bf7fb6e.7aac88","name":"Reset","rules":[{"t":"set","p":"reset","pt":"msg","to":"-2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":400,"wires":[["dcb91f9a8bdd378c"]]},{"id":"e99a925122131857","type":"switch","z":"9bf7fb6e.7aac88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on-press","vt":"str"},{"t":"eq","v":"off-press","vt":"str"},{"t":"regex","v":"(on|off)-hold.*","vt":"str","case":false},{"t":"regex","v":"(up|down)-.*","vt":"str","case":false}],"checkall":"false","repair":false,"outputs":4,"x":1350,"y":520,"wires":[["dcb91f9a8bdd378c"],["0b39606137f3b53b"],["a6612ee84c8165b6"],["6fec77bf84b273af"]]},{"id":"36709a03fc5a1886","type":"switch","z":"9bf7fb6e.7aac88","name":"ON?","property":"count","propertyType":"msg","rules":[{"t":"gte","v":"-1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1610,"y":400,"wires":[["024f2e1ab29e5646"]]},{"id":"0b39606137f3b53b","type":"function","z":"9bf7fb6e.7aac88","name":"off-press","func":"var payload = {state: \"off\"};\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1620,"y":520,"wires":[["de0c260325a84190"]]},{"id":"a6612ee84c8165b6","type":"function","z":"9bf7fb6e.7aac88","name":"(on|off)-hold.*","func":"var payload = {\n    \"on-hold\": {color_temp_move: 60},\n    \"off-hold\": {color_temp_move: -60},\n    \"on-hold-release\": {color_temp_move: \"stop\"},\n    \"off-hold-release\": {color_temp_move: \"stop\"}\n}[msg.payload];\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1640,"y":560,"wires":[["de0c260325a84190"]]},{"id":"6fec77bf84b273af","type":"function","z":"9bf7fb6e.7aac88","name":"(up|down)-.*","func":"var payload = {\n    \"up-press\": {brightness_step: 40},\n    \"down-press\": {brightness_step: -40},\n    \"up-hold\": {brightness_move: 80},\n    \"down-hold\": {brightness_move: -80},\n    \"up-hold-release\": {brightness_move: \"stop\"},\n    \"down-hold-release\": {brightness_move: \"stop\"}\n}[msg.payload];\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1630,"y":600,"wires":[["de0c260325a84190"]]},{"id":"024f2e1ab29e5646","type":"function","z":"9bf7fb6e.7aac88","name":"on-press","func":"const startup_scene = {brightness: 254, color_temp: 370};\n\n// https://community.home-assistant.io/t/circadian-lighting-for-philips-hue-white-ambiance/84926\nconst additional_scenes = [\n    {brightness: 254, color_temp: 153} // Energize\n    , {brightness: 144, color_temp: 447} // Relax\n    , {brightness: 254, color_temp: 230} // Concentrate \n    , {brightness: 254, color_temp: 343} // Read\n] || []; // && to exclude, || to include additional scenes\n\nconst scenes = [\n    startup_scene\n    , ...additional_scenes\n];\n\nlet payload = (msg.count == -1) ? {state: \"on\"} : scenes[msg.count % scenes.length]; // round robin\n\nreturn {\n    room: msg.room,\n    payload: payload\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1620,"y":480,"wires":[["56c908eb76e35c0a"]]},{"id":"f8ce0fd5dfc0e129","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Arbeitszimmer","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.arbeitszimmer","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"arbeitszimmer","valueType":"str"}],"x":690,"y":160,"wires":[["6485f031a069570e"]]},{"id":"39ec7c2925e3806a","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Arbeitszimmer","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.arbeitszimmer_dimmer_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"arbeitszimmer","valueType":"str"}],"x":250,"y":160,"wires":[["96eee9d9afac6ecd"]]},{"id":"40f6105f1d42342b","type":"switch","z":"9bf7fb6e.7aac88","name":"hold?","property":"payload","propertyType":"msg","rules":[{"t":"regex","v":".*hold$","vt":"str","case":false},{"t":"neq","v":"","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":1090,"y":520,"wires":[["a36f5b01761a11f8"],["e99a925122131857"]]},{"id":"a36f5b01761a11f8","type":"rbe","z":"9bf7fb6e.7aac88","name":"","func":"rbe","gap":"","start":"","inout":"out","septopics":true,"property":"payload","topi":"room","x":1210,"y":480,"wires":[["e99a925122131857"]]},{"id":"4263e0699687a860","type":"mqtt out","z":"9bf7fb6e.7aac88","name":"","topic":"","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"dc1fcbdb1d762196","x":2310,"y":640,"wires":[]},{"id":"a82d4cbd50df8771","type":"api-current-state","z":"9bf7fb6e.7aac88","name":"Licht aus?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{light}}","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"light","propertyType":"msg","value":"","valueType":"triggerId"}],"for":"1","forType":"num","forUnits":"seconds","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":770,"y":1060,"wires":[["e8d46d88cfa0aebe"],[]]},{"id":"9021b8950eb82a44","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.licht_arbeitszimmer","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":210,"y":860,"wires":[["8b8c5e79e40b176b"],[]]},{"id":"e8d46d88cfa0aebe","type":"api-call-service","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"switch","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{switch}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":940,"y":1060,"wires":[["9cf2bf8879ec350d"]]},{"id":"5202597b46f4358f","type":"api-current-state","z":"9bf7fb6e.7aac88","name":"Schalter an?","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{switch}}","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"light","propertyType":"msg","value":"","valueType":"triggerId"}],"for":"1","forType":"num","forUnits":"seconds","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1970,"y":480,"wires":[["0ea45ed45f7f052d"],["b96304986ae5799d"]]},{"id":"fbf4c96dd0dc2446","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["0ea45ed45f7f052d","de0c260325a84190"],"x":2045,"y":640,"wires":[["65640ec49cb9ce31"]]},{"id":"0ea45ed45f7f052d","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["fbf4c96dd0dc2446"],"x":2235,"y":460,"wires":[]},{"id":"de0c260325a84190","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["fbf4c96dd0dc2446"],"x":1785,"y":560,"wires":[]},{"id":"d1868da58c58188a","type":"inject","z":"9bf7fb6e.7aac88","name":"Inject rooms","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"0","topic":"","payload":"{\"arbeitszimmer\":{\"switch\":\"switch.licht_arbeitszimmer\",\"light\":\"light.arbeitszimmer\",\"topic\":\"arbeitszimmer-deckenleuchte\"},\"kueche\":{\"switch\":\"switch.licht_kueche_2\",\"light\":\"light.kuche\",\"topic\":\"kueche-deckenleuchte\"},\"nino\":{\"switch\":\"switch.licht_nino\",\"light\":\"light.nino\",\"topic\":\"nino\"},\"noah\":{\"switch\":\"switch.licht_noah\",\"light\":\"light.noah\",\"topic\":\"noah\"},\"schlafzimmer\":{\"switch\":\"switch.licht_schlafzimmer\",\"light\":\"light.schlafzimmer\",\"topic\":\"schlafzimmer\"},\"wohnzimmer\":{\"switch\":\"switch.licht_wohnzimmer\",\"light\":\"light.wohnzimmer\",\"topic\":\"wohnzimmer\"}}","payloadType":"json","x":230,"y":60,"wires":[["37b4dabbce728f88"]]},{"id":"37b4dabbce728f88","type":"change","z":"9bf7fb6e.7aac88","name":"","rules":[{"t":"set","p":"#:(store)::rooms","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":60,"wires":[[]]},{"id":"c8ddb08d7c17a051","type":"change","z":"9bf7fb6e.7aac88","name":"setze msg.switch & msg.light","rules":[{"t":"set","p":"switch","pt":"msg","to":"$lookup(\t   $lookup(\t       $flowContext('rooms', 'store'),\t       msg.room\t   ),\t   'switch'\t)","tot":"jsonata"},{"t":"set","p":"light","pt":"msg","to":"$lookup(\t   $lookup(\t       $flowContext('rooms', 'store'),\t       msg.room\t   ),\t   'light'\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":980,"wires":[["a82d4cbd50df8771"]]},{"id":"8b8c5e79e40b176b","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"arbeitszimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":860,"wires":[["3d5ca12ff218d542"]]},{"id":"96eee9d9afac6ecd","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["15de1c31bfbbd7af","75fe50d8b23b078c","2092a9e88d2690e4"],"x":415,"y":320,"wires":[]},{"id":"15de1c31bfbbd7af","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["96eee9d9afac6ecd","63841c973ad2716a"],"x":1005,"y":520,"wires":[["40f6105f1d42342b"]]},{"id":"9cf2bf8879ec350d","type":"api-call-service","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{light}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1110,"y":1060,"wires":[[]]},{"id":"84900d20942bac03","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.licht_schlafzimmer","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":210,"y":920,"wires":[["238028061159925e"],[]]},{"id":"238028061159925e","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"schlafzimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":920,"wires":[["3d5ca12ff218d542"]]},{"id":"b5356def0be59eb9","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Schlafzimmer Bella","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.schlafzimmer_dimmer_bella_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"schlafzimmer","valueType":"str"}],"x":230,"y":280,"wires":[["96eee9d9afac6ecd"]]},{"id":"9476d61d47d3fba6","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Schlafzimmer Jan","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.schlafzimmer_dimmer_jan_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"schlafzimmer","valueType":"str"}],"x":230,"y":340,"wires":[["96eee9d9afac6ecd"]]},{"id":"3d5ca12ff218d542","type":"change","z":"9bf7fb6e.7aac88","name":"lösche Rest","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"delete","p":"topic","pt":"msg"},{"t":"delete","p":"data","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":980,"wires":[["c8ddb08d7c17a051"]]},{"id":"dcb91f9a8bdd378c","type":"function","z":"9bf7fb6e.7aac88","name":"Counter per room","func":"counters = context.get(\"counters\");\nvar room = msg.room;\n\ncounters[room] = (\"reset\" in msg) ? -2 : (room in counters ? counters[room] : -2) + 1;\nmsg.count = counters[room];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"context.set(\"counters\", {});","finalize":"","libs":[],"x":1450,"y":400,"wires":[["36709a03fc5a1886"]]},{"id":"36f9e5b9c8484459","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Schlafzimmer","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.schlafzimmer","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"schlafzimmer","valueType":"str"}],"x":690,"y":220,"wires":[["6485f031a069570e"]]},{"id":"56c908eb76e35c0a","type":"change","z":"9bf7fb6e.7aac88","name":"","rules":[{"t":"set","p":"switch","pt":"msg","to":"$lookup(\t   $lookup(\t       $flowContext('rooms', 'store'),\t       msg.room\t   ),\t   'switch'\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1790,"y":480,"wires":[["5202597b46f4358f"]]},{"id":"65640ec49cb9ce31","type":"change","z":"9bf7fb6e.7aac88","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"$join(\t   [\t       'zigbee2mqtt/',\t       $lookup(\t           $lookup(\t               $flowContext('rooms', 'store'),\t               msg.room\t   ),\t           'topic'\t),\t       '/set'\t   ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":640,"wires":[["4263e0699687a860","5265d1f4affb8841"]]},{"id":"ab2fecd248024105","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["f21a5f7335339be9"],"x":1185,"y":400,"wires":[["903dfb0649325202"]]},{"id":"f21a5f7335339be9","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["ab2fecd248024105"],"x":975,"y":300,"wires":[]},{"id":"bafd6d2798787d01","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.licht_kueche_2","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"new_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"old_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":980,"wires":[["02f7e42f1ba6d796"],[]]},{"id":"02f7e42f1ba6d796","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"kueche","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":980,"wires":[["3d5ca12ff218d542"]]},{"id":"e9f12d6e90657db6","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Küche","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.kuche","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"kueche","valueType":"str"}],"x":710,"y":280,"wires":[["6485f031a069570e"]]},{"id":"14d9ee980a59c8fa","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Küche","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.kueche_dimmer_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"kueche","valueType":"str"}],"x":270,"y":220,"wires":[["96eee9d9afac6ecd"]]},{"id":"820a0701c18ca170","type":"comment","z":"9bf7fb6e.7aac88","name":"Dimmer","info":"","x":450,"y":240,"wires":[]},{"id":"950819b281f30f29","type":"comment","z":"9bf7fb6e.7aac88","name":"Licht","info":"","x":930,"y":220,"wires":[]},{"id":"6485f031a069570e","type":"switch","z":"9bf7fb6e.7aac88","name":"off?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":890,"y":300,"wires":[["f21a5f7335339be9"]]},{"id":"5265d1f4affb8841","type":"debug","z":"9bf7fb6e.7aac88","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2310,"y":600,"wires":[]},{"id":"8ce53f84bdcfbf1c","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.licht_nino","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":240,"y":1040,"wires":[["620b0b5ae0673ac5"],[]]},{"id":"620b0b5ae0673ac5","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"nino","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":1040,"wires":[["3d5ca12ff218d542"]]},{"id":"8267de4b355e9290","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Nino","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.nino","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"nino","valueType":"str"}],"x":710,"y":340,"wires":[["6485f031a069570e"]]},{"id":"033ec9119641a670","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Nino","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.nino_dimmer_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"nino","valueType":"str"}],"x":270,"y":400,"wires":[["96eee9d9afac6ecd"]]},{"id":"d5f530707ef32996","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Noah","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.noah","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"noah","valueType":"str"}],"x":710,"y":400,"wires":[["6485f031a069570e"]]},{"id":"920b1fde95f21d31","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Noah","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.noah_dimmer_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"noah","valueType":"str"}],"x":270,"y":460,"wires":[["96eee9d9afac6ecd"]]},{"id":"5a9b1cbde77aeea5","type":"trigger-state","z":"9bf7fb6e.7aac88","name":"","server":"a0992e23.0acf8","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.licht_noah","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":230,"y":1100,"wires":[["8efd63d256968dd8"],[]]},{"id":"8efd63d256968dd8","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"noah","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":1100,"wires":[["3d5ca12ff218d542"]]},{"id":"63841c973ad2716a","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["15de1c31bfbbd7af","75fe50d8b23b078c","2092a9e88d2690e4"],"x":915,"y":660,"wires":[]},{"id":"08179cb82cfbcd95","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Wohnzimmer","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.wohnzimmer","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"wohnzimmer","valueType":"str"}],"x":690,"y":460,"wires":[["6485f031a069570e"]]},{"id":"137007d599a02ece","type":"server-state-changed","z":"9bf7fb6e.7aac88","name":"Wohnzimmer","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.wohnzimmer_dimmer_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"room","propertyType":"msg","value":"wohnzimmer","valueType":"str"}],"x":250,"y":520,"wires":[["96eee9d9afac6ecd"]]},{"id":"e2c606c088b7a2f5","type":"change","z":"9bf7fb6e.7aac88","name":"setze Raum","rules":[{"t":"set","p":"room","pt":"msg","to":"wohnzimmer","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":660,"wires":[["63841c973ad2716a"]]},{"id":"44a20062731a4a0e","type":"comment","z":"9bf7fb6e.7aac88","name":"Konfiguration","info":"","x":630,"y":60,"wires":[]},{"id":"b326206678251299","type":"comment","z":"9bf7fb6e.7aac88","name":"Dimmer (Wandtaster)","info":"","x":220,"y":600,"wires":[]},{"id":"bbcc6a4694801bb8","type":"comment","z":"9bf7fb6e.7aac88","name":"Wandschalter aus, wenn Licht aus (→ einschalten!)","info":"","x":790,"y":900,"wires":[]},{"id":"c99ba34d9419d2c1","type":"link in","z":"9bf7fb6e.7aac88","name":"","links":["72202d9b16981d7c"],"x":205,"y":660,"wires":[["c1468a42eea018f0"]]},{"id":"72202d9b16981d7c","type":"link out","z":"9bf7fb6e.7aac88","name":"","mode":"link","links":["c99ba34d9419d2c1"],"x":375,"y":740,"wires":[]},{"id":"9884b3f4f7c828fe","type":"ha-get-entities","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":0,"rules":[{"property":"entity_id","logic":"starts_with","value":"climate.","valueType":"str"},{"property":"state","logic":"is","value":"off","valueType":"str"}],"output_type":"array","output_empty_results":false,"output_location_type":"msg","output_location":"payload","output_results_count":1,"x":390,"y":320,"wires":[["8c6329b0899b7246"]]},{"id":"2b453a5fbbfabacc","type":"split","z":"6dc4c1678ae71fb6","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":330,"y":480,"wires":[["78aecbdb56874758"]]},{"id":"78aecbdb56874758","type":"change","z":"6dc4c1678ae71fb6","name":"entity_id","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.entity_id","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":480,"wires":[["1557249163680d8c"]]},{"id":"8c6329b0899b7246","type":"change","z":"6dc4c1678ae71fb6","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"},{"t":"set","p":"hvac_mode","pt":"msg","to":"heat","tot":"str"},{"t":"set","p":"temperature","pt":"msg","to":"30","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":320,"wires":[["60d48c5acf6bc360"]]},{"id":"dd7f1dee01933224","type":"api-call-service","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"climate","service":"set_temperature","areaId":[],"deviceId":[],"entityId":["all"],"data":"{\"hvac_mode\":\"heat\", \"temperature\":msg.temperature}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":410,"y":540,"wires":[["d352a34b7d80f880"]]},{"id":"89f00d1e5ea40a2b","type":"ha-get-entities","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":0,"rules":[{"property":"entity_id","logic":"starts_with","value":"climate.","valueType":"str"},{"property":"state","logic":"is","value":"heat","valueType":"str"},{"property":"attributes.temperature","logic":"gte","value":"24","valueType":"num"}],"output_type":"array","output_empty_results":false,"output_location_type":"msg","output_location":"payload","output_results_count":1,"x":390,"y":380,"wires":[["bed3eb09582d20c2"]]},{"id":"e3b44a9ca2e1b0ae","type":"link in","z":"6dc4c1678ae71fb6","name":"","links":["60d48c5acf6bc360","ab07a2886360d175"],"x":245,"y":480,"wires":[["2b453a5fbbfabacc"]]},{"id":"60d48c5acf6bc360","type":"link out","z":"6dc4c1678ae71fb6","name":"","mode":"link","links":["e3b44a9ca2e1b0ae"],"x":695,"y":320,"wires":[]},{"id":"bed3eb09582d20c2","type":"change","z":"6dc4c1678ae71fb6","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"},{"t":"set","p":"hvac_mode","pt":"msg","to":"off","tot":"str"},{"t":"set","p":"temperature","pt":"msg","to":"5","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":380,"wires":[["ab07a2886360d175"]]},{"id":"ab07a2886360d175","type":"link out","z":"6dc4c1678ae71fb6","name":"","mode":"link","links":["e3b44a9ca2e1b0ae"],"x":695,"y":380,"wires":[]},{"id":"e504fa5ac1ee1133","type":"time-inject","z":"6dc4c1678ae71fb6","name":"","nameInt":"⏲ 17:52:30[Fr] = Zeitpunkt","positionConfig":"a962ddc.fbff22","props":[{"p":"","pt":"msgPayload","v":"","vt":"date","o":"","oT":"none","oM":"60000","f":0,"fS":0,"fT":"Millisekunden UNIX-Zeit","fI":"0","next":true,"days":"*","months":"*","onlyOddDays":false,"onlyEvenDays":false,"onlyOddWeeks":false,"onlyEvenWeeks":false}],"injectTypeSelect":"time","intervalCount":1,"intervalCountType":"num","intervalCountMultiplier":60000,"cron":"","cronType":"cronexpr","time":"17:52:30","timeType":"entered","offset":0,"offsetType":"none","offsetMultiplier":60000,"timeEnd":"","timeEndType":"entered","timeEndOffset":0,"timeEndOffsetType":"none","timeEndOffsetMultiplier":60000,"timeDays":"5","timeOnlyOddDays":false,"timeOnlyEvenDays":false,"timeOnlyOddWeeks":true,"timeOnlyEvenWeeks":false,"timeMonths":"*","timedatestart":"","timedateend":"","property":"","propertyType":"none","propertyCompare":"true","propertyThreshold":"","propertyThresholdType":"num","timeAlt":"","timeAltType":"entered","timeAltDays":"*","timeAltOnlyOddDays":false,"timeAltOnlyEvenDays":false,"timeAltOnlyOddWeeks":false,"timeAltOnlyEvenWeeks":false,"timeAltMonths":"*","timeAltOffset":0,"timeAltOffsetType":"none","timeAltOffsetMultiplier":60000,"once":false,"onceDelay":0.1,"recalcTime":2,"x":190,"y":320,"wires":[["9884b3f4f7c828fe"]]},{"id":"8888fc7c7ca55def","type":"inject","z":"6dc4c1678ae71fb6","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"0 0-23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":230,"y":380,"wires":[["89f00d1e5ea40a2b"]]},{"id":"a47a6b54249f8969","type":"server-state-changed","z":"6dc4c1678ae71fb6","name":"Modus zurücksetzen","server":"a0992e23.0acf8","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_select.climate_mode_global_reset","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"<bitte wählen>","halt_if_type":"str","halt_if_compare":"is_not","outputs":2,"output_only_on_state_change":false,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":60,"wires":[["0cbb1b8307d4f603"],[]]},{"id":"8c285f030b283402","type":"time-inject","z":"6dc4c1678ae71fb6","name":"","nameInt":"⏲ 17:45:00 = Zeitpunkt","positionConfig":"a962ddc.fbff22","props":[{"p":"","pt":"msgPayload","v":"","vt":"date","o":"","oT":"none","oM":"60000","f":0,"fS":0,"fT":"Millisekunden UNIX-Zeit","fI":"0","next":true,"days":"*","months":"*","onlyOddDays":false,"onlyEvenDays":false,"onlyOddWeeks":false,"onlyEvenWeeks":false}],"injectTypeSelect":"time","intervalCount":1,"intervalCountType":"num","intervalCountMultiplier":60000,"cron":"","cronType":"cronexpr","time":"17:45:00","timeType":"entered","offset":0,"offsetType":"none","offsetMultiplier":60000,"timeEnd":"","timeEndType":"entered","timeEndOffset":0,"timeEndOffsetType":"none","timeEndOffsetMultiplier":60000,"timeDays":"*","timeOnlyOddDays":false,"timeOnlyEvenDays":false,"timeOnlyOddWeeks":false,"timeOnlyEvenWeeks":false,"timeMonths":"*","timedatestart":"","timedateend":"","property":"","propertyType":"none","propertyCompare":"true","propertyThreshold":"","propertyThresholdType":"num","timeAlt":"","timeAltType":"entered","timeAltDays":"*","timeAltOnlyOddDays":false,"timeAltOnlyEvenDays":false,"timeAltOnlyOddWeeks":false,"timeAltOnlyEvenWeeks":false,"timeAltMonths":"*","timeAltOffset":0,"timeAltOffsetType":"none","timeAltOffsetMultiplier":60000,"once":false,"onceDelay":0.1,"recalcTime":2,"x":200,"y":120,"wires":[["97d95bf601c81af0"]]},{"id":"97d95bf601c81af0","type":"api-current-state","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":3,"outputs":2,"halt_if":"<bitte wählen>","halt_if_type":"str","halt_if_compare":"is_not","entity_id":"input_select.climate_mode_global_reset_daily","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"}],"for":"0","forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":540,"y":120,"wires":[["b74157866832137c"],[]]},{"id":"b74157866832137c","type":"api-call-service","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"climate","service":"set_hvac_mode","areaId":[],"deviceId":[],"entityId":["all"],"data":"{\"hvac_mode\":msg.payload}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":890,"y":120,"wires":[[]]},{"id":"ea09ab99a06735ad","type":"api-call-service","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"input_select","service":"select_first","areaId":[],"deviceId":[],"entityId":["{{topic}}"],"data":"","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":670,"y":60,"wires":[[]]},{"id":"0cbb1b8307d4f603","type":"api-call-service","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"climate","service":"set_hvac_mode","areaId":[],"deviceId":[],"entityId":["all"],"data":"{\"hvac_mode\":msg.payload}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":430,"y":60,"wires":[["ea09ab99a06735ad"]]},{"id":"26af6979b0a2cd9b","type":"api-call-service","z":"6dc4c1678ae71fb6","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"climate","service":"set_hvac_mode","areaId":[],"deviceId":[],"entityId":["all"],"data":"{\"hvac_mode\":msg.hvac_mode}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"all","x":770,"y":540,"wires":[[]]},{"id":"d352a34b7d80f880","type":"switch","z":"6dc4c1678ae71fb6","name":"off?","property":"hvac_mode","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":590,"y":540,"wires":[["26af6979b0a2cd9b"]]},{"id":"1557249163680d8c","type":"join","z":"6dc4c1678ae71fb6","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":"false","timeout":"","count":"","reduceRight":false,"x":590,"y":480,"wires":[["493f6ac3f2267163"]]},{"id":"493f6ac3f2267163","type":"debug","z":"6dc4c1678ae71fb6","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":480,"wires":[]},{"id":"3e5dcf464cb35452","type":"api-call-service","z":"f2681015255691ca","name":"","server":"a0992e23.0acf8","version":5,"debugenabled":false,"domain":"notify","service":"all_mobiles","areaId":[],"deviceId":[],"entityId":[],"data":"{\"title\": \"Waschmaschine fertig!\", \"message\": \"Du kannst sie nun ausräumen.\"}","dataType":"jsonata","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1090,"y":200,"wires":[[]]},{"id":"bb5c32f0f1321f95","type":"switch","z":"f2681015255691ca","name":"","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"3","vt":"num"},{"t":"gt","v":"0.5","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":250,"y":200,"wires":[["3b5f092aea904e06"],["ac2d58804b5fc509"],["61e6992feec7f57d"]]},{"id":"3b5f092aea904e06","type":"change","z":"f2681015255691ca","name":"running","rules":[{"t":"set","p":"payload","pt":"msg","to":"running","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":160,"wires":[["720f80fd3f170dd3"]]},{"id":"ac2d58804b5fc509","type":"change","z":"f2681015255691ca","name":"standby","rules":[{"t":"set","p":"payload","pt":"msg","to":"standby","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":200,"wires":[["720f80fd3f170dd3"]]},{"id":"61e6992feec7f57d","type":"change","z":"f2681015255691ca","name":"off","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":240,"wires":[["720f80fd3f170dd3"]]},{"id":"720f80fd3f170dd3","type":"state-machine","z":"f2681015255691ca","name":"Status","triggerProperty":"payload","triggerPropertyType":"msg","stateProperty":"payload","statePropertyType":"msg","initialDelay":"0","persistOnReload":false,"outputStateChangeOnly":false,"throwException":false,"states":["start","aus","wartet","arbeitet","fertig"],"transitions":[{"name":"running","from":"*","to":"arbeitet"},{"name":"standby","from":"arbeitet","to":"fertig"},{"name":"standby","from":"fertig","to":"fertig"},{"name":"standby","from":"*","to":"wartet"},{"name":"off","from":"*","to":"aus"}],"x":550,"y":200,"wires":[["660df2ca0d1fc17b"]]},{"id":"e3a74ca9c923f18a","type":"switch","z":"f2681015255691ca","name":"fertig?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"fertig","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":930,"y":200,"wires":[["3e5dcf464cb35452"]]},{"id":"e799b506a5f74ddb","type":"link in","z":"f2681015255691ca","name":"","links":["9ab2798660f05b4a","ee3d77ef2ddd8263","657dbd9402935009"],"x":165,"y":200,"wires":[["bb5c32f0f1321f95"]]},{"id":"657dbd9402935009","type":"link out","z":"f2681015255691ca","name":"","mode":"link","links":["53911cca546ed47a","e799b506a5f74ddb"],"x":605,"y":80,"wires":[]},{"id":"cdf8f935c29e0d78","type":"link out","z":"f2681015255691ca","name":"","mode":"link","links":["f5c30f1d88eaa105"],"x":755,"y":200,"wires":[]},{"id":"f5c30f1d88eaa105","type":"link in","z":"f2681015255691ca","name":"","links":["9ab2798660f05b4a","cdf8f935c29e0d78"],"x":825,"y":140,"wires":[["47d0b5d7940e7cf8","e3a74ca9c923f18a"]]},{"id":"660df2ca0d1fc17b","type":"rbe","z":"f2681015255691ca","name":"","func":"rbei","gap":"","start":"","inout":"out","septopics":false,"property":"payload","topi":"topic","x":670,"y":200,"wires":[["cdf8f935c29e0d78"]]},{"id":"47d0b5d7940e7cf8","type":"ha-entity","z":"f2681015255691ca","name":"Waschmaschine: Status","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"Waschmaschine: Status"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:washing-machine"},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"payload","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"","outputPayloadType":"str","x":990,"y":140,"wires":[[]]},{"id":"14c2b510a5d538ec","type":"ha-entity","z":"f2681015255691ca","name":"Waschmaschine: mittlere Leistung","server":"a0992e23.0acf8","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"Waschmaschine: mittlere Leistung"},{"property":"device_class","value":"power"},{"property":"icon","value":""},{"property":"unit_of_measurement","value":"W"},{"property":"state_class","value":"measurement"},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"payload","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"","outputPayloadType":"str","x":780,"y":40,"wires":[[]]},{"id":"d5f819b4e7854c9d","type":"poll-state","z":"f2681015255691ca","name":"Waschmaschine: Leistung","server":"a0992e23.0acf8","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"updateinterval":"10","updateIntervalType":"num","updateIntervalUnits":"seconds","outputinitially":true,"outputonchanged":false,"entity_id":"sensor.steckdose_waschmaschine_current_consumption","state_type":"num","halt_if":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"x":150,"y":40,"wires":[["258e9ad866ea0af4"]]},{"id":"258e9ad866ea0af4","type":"function","z":"f2681015255691ca","name":"time-weighted average (over 60s)","func":"/*\ntime-weighted average of payload values\nover the specified time range (in ms)\n*/\n\nlet now = Date.now();\nconst range = 60 * 1000;\n\nlet t = context.get('t') || now - range;\nlet T = context.get('T');\nlet F = context.get('F');\nlet buffer = context.get('buffer');\n\nlet dt = now - t;\nlet increment = {dt: dt, df: Number(msg.payload) * dt};\n\nT += increment.dt;\nF += increment.df;\nbuffer.push(increment);\n\nwhile ((T - buffer[0].dt) >= range) {\n  T -= buffer[0].dt;\n  F -= buffer[0].df;\n  buffer.shift();\n}\n\ncontext.set('t', now);\ncontext.set('T', T);\ncontext.set('F', F);\ncontext.set('buffer', buffer);\n\nmsg.payload = Number((F / T).toFixed(1));\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"context.set('t', undefined);\ncontext.set('T', 0);\ncontext.set('F', 0);\ncontext.set('buffer', []);","finalize":"","libs":[],"x":420,"y":40,"wires":[["657dbd9402935009","14c2b510a5d538ec"]]},{"id":"6142d5d943690a02","type":"function","z":"edc1527de2d701a7","name":"verzögere Deaktivierung","func":"if (typeof msg.delay == \"number\") {\n    context.set(\"delay\", msg.delay)\n}\nconst delay = context.get(\"delay\"); \n\nfunction setState (state) {\n    context.set(\"state\", state);\n    var deadline = context.get(\"deadline\");\n    var status = {\n        \"fill\": state ? \"red\" : \"green\",\n        \"shape\": deadline ? \"ring\" : \"dot\"  ,\n        \"text\": state + (deadline ? ` (until ${deadline})` : \"\")\n    };\n    node.status(status);\n}\n\nfunction set (timeout, deadline, state) {\n    context.set(\"timeout\", timeout);\n    context.set(\"deadline\", deadline);\n    setState(state);    \n}\n\nfunction send (msg) {\n    set(undefined, undefined, msg.payload);\n    node.send(msg);\n}\n\nvar state = context.get(\"state\");\nvar timeout = context.get(\"timeout\");\nvar deadline = context.get(\"deadline\");\n\nif (typeof msg.payload !== \"boolean\") {\n    return msg;\n} \n\nif (!state) {\n    setState(msg.payload);\n    return msg;\n}\n\nif (msg.payload) {\n    if (timeout) {\n        clearTimeout(timeout);\n        set(undefined, undefined, state);\n    }\n    return;\n}\n\nif (!timeout) {\n    set(\n        setTimeout(send, delay, msg),\n        new Date(Date.now() + delay).toLocaleTimeString('us-US', {\"hourCycle\": \"h23\"}),\n        state\n    );\n}\n","outputs":1,"noerr":0,"initialize":"context.set(\"delay\", 60000);\nnode.status({\"fill\": \"grey\", \"shape\": \"ring\"});","finalize":"","libs":[],"x":250,"y":360,"wires":[[]]}]